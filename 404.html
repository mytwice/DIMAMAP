<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VZNJWS2EY3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VZNJWS2EY3');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIMA MAP</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #ffffff;
            overflow: hidden; /* í˜ì´ì§€ì—ì„œ ìŠ¤í¬ë¡¤ë°”ë¥¼ ìˆ¨ê¹ë‹ˆë‹¤ */
        }

        /* ìŠ¤í¬ë¡¤ë°” ì „ì²´ ì˜ì—­ */
        ::-webkit-scrollbar {
            width: 18px;  /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ë°” ë„ˆë¹„ */
            height: 15px; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ë°” ë†’ì´ */
        }

        /* ìŠ¤í¬ë¡¤ë°” ë°°ê²½ */
        ::-webkit-scrollbar-track {
            background: #f1f1f1; /* ë°ì€ íšŒìƒ‰ */
            border-radius: 10px;
        }

        /* ìŠ¤í¬ë¡¤ë°” ë§‰ëŒ€ (ë“œë˜ê·¸ ê°€ëŠ¥) */
        ::-webkit-scrollbar-thumb {
            background: #e155b5; /* í•‘í¬ ê³„ì—´ ìƒ‰ìƒ */
            border-radius: 35px;
            border: 2px solid #f1f1f1; /* ë°°ê²½ê³¼ ì¡°í™”ë¡­ê²Œ */
        }

        /* ìŠ¤í¬ë¡¤ë°” í˜¸ë²„ íš¨ê³¼ */
        ::-webkit-scrollbar-thumb:hover {
            background: #c64aa3; /* ë” ì§„í•œ í•‘í¬ */
        }

        #map-wrapper {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
            background: #8b8b8b;
        }

        #map-container {
            position: absolute;
            transform-origin: 0 0;
            cursor: grab;
            width: 100%;
            height: 100%;
        }

        #map-container:active {
            cursor: grabbing;
        }

        #map-image {
            width: 1200px;
            height: 900px;
            user-select: none;
            object-fit: contain; 
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
        }

        /* ìƒë‹¨ ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 1200px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 9999;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;  /* í•­ëª©ë“¤ì„ ì¤„ ë°”ê¿ˆì´ ê°€ëŠ¥í•˜ê²Œ í•¨ */
            gap: 16px;  /* í•­ëª© ê°„ì˜ ê°„ê²© */
        }

            /* ê²€ìƒ‰ì°½ */
            .search-container {
            left: 50%;
            display: flex;

            gap: 40px; /* íƒ€ì´í‹€ê³¼ ê²€ìƒ‰ì°½ ê°„ ê°„ê²© */
            margin-bottom: 00px; /* ì»¨í…Œì´ë„ˆ ê°„ ê°„ê²© */
        }

        .search-results {
            position: absolute;
            top: 100%;  /* ì…ë ¥ í•„ë“œ ë°”ë¡œ ì•„ë˜ ë°°ì¹˜ */
            left: 0;
            width: 100%;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 200px; /* ê²€ìƒ‰ ê²°ê³¼ê°€ ë„ˆë¬´ ê¸¸ì–´ì§€ì§€ ì•Šë„ë¡ ì œí•œ */
            overflow-y: auto; /* ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        }

        .search-result-item {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s;
        }

        .search-result-item:hover {
            background: #f0f0f0;
        }

        .search-title {
            font-size: 22px;
            font-weight: bold;
            color: #333;
        }

        .search-input {
            flex: 1; /* ì…ë ¥ ì°½ì´ ë‚¨ì€ ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        /* í•„í„°ë§ ê·¸ë£¹ì„ 1ì¤„ì— ë°°ì¹˜ */
        .filter-group {
            display: flex;
            gap: 16px;
            flex-wrap: nowrap;  /* í•„í„° ê·¸ë£¹ì€ í•œ ì¤„ì— ë°°ì¹˜ */
        }

        #category-filter {
            display: flex;
            flex-wrap: nowrap;  /* í•œ ì¤„ë¡œ ë°°ì¹˜ */
            gap: 10px;
            width: 100%;  /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
            overflow-x: auto;  /* ê°€ë¡œ ìŠ¤í¬ë¡¤ì„ ì¶”ê°€ */
            padding-bottom: 10px;  /* ìŠ¤í¬ë¡¤ë°”ê°€ ë³´ì´ë„ë¡ ì•„ë˜ ì—¬ë°± ì¶”ê°€ */
        }

        #category-filter label {
            background: #e155b5;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            white-space: nowrap;
            font-size: 14px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-size: 14px;
        }

        .filter-select {
            width: 150px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .filter-button {
            padding: 12px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .filter-button:hover {
            background: #1976D2;
        }

        /* í•€ ë° ì •ë³´ ë°•ìŠ¤ */
        .pin {
            position: absolute;
            width: 30px;
            height: 30px;
            z-index: 1000;
            cursor: pointer;
            transform: translate(-50%, -95%);
            transition: transform 0.2s;
        }


        /* 1ìˆœìœ„ í•€ ìŠ¤íƒ€ì¼ - ë§ˆì»¤ ëª¨ì–‘ */
        .pin-primary::before {
            content: '';
            position: absolute;
            width: 30px;
            height: 30px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23E91E63"><path d="M12 0C7.6 0 4 3.6 4 8c0 5.4 8 16 8 16s8-10.6 8-16c0-4.4-3.6-8-8-8zm0 12c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"/></svg>') no-repeat center center;
            background-size: contain;
        }

        /* 2ìˆœìœ„ í•€ ìŠ¤íƒ€ì¼ - ì›í˜• */
        .pin-secondary {
            position: absolute; /* Ensure absolute positioning */
            width: 10px; /* Fixed width */
            height: 10px; /* Fixed height */
            background-color: #E91E63; /* Pink color */
            border-radius: 50%; /* Circular shape */
            border: 1px solid white; /* White border */
            box-shadow: 0 2px 4px rgba(0,0,0,0.2); /* Subtle shadow */
            transform: translate(-50%, -50%) scale(0.26); /* Center the pin */
            z-index: 1000; /* Ensure it's above other elements */
        }

        /* í•€ ë¼ë²¨ ìŠ¤íƒ€ì¼ */
        .pin-label {
            position: absolute;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            font-size: 7px;
            transform: translate(77%, 20%);
            border-radius: 5px;
            white-space: nowrap;
            text-align: center;
            display: none;
            z-index: 1001;
            transition: all 0.2s ease-in-out;
        }

        .pin-label2 {
            position: absolute;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            font-size: 7px;
            transform: translate(110%, -39%) scale(2.2);
            border-radius: 5px;
            white-space: nowrap;
            text-align: center;
            display: none;
            z-index: 1001;
            transition: all 0.2s ease-in-out;
        }
        
        .pin-info-box {
            position: fixed;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
            z-index: 1001;
            max-width: 300px;
            font-size: 14px;
            line-height: 1.6;
        }

        .pin-info-box strong {
            color: #333;
            display: inline-block;
            width: 80px;
        }

        .pin-info-box a {
            color: #2196F3;
            text-decoration: none;
        }

        .pin-info-box a:hover {
            text-decoration: underline;
        }

        .pin-info-box .close-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 18px;
            cursor: pointer;
            color: #666;
            line-height: 1;
        }

        .pin-info-box .close-btn:hover {
            color: #333;
        }

        /* ì¹´í…Œê³ ë¦¬ ìŠ¤í¬ë¡¤ */
        .category-scroll {
            display: flex;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding: 10px 0;
            gap: 10px;
        }

        .category-item {
            flex: 0 0 auto;
            padding: 8px 16px;
            background: #f0f0f0;
            border-radius: 20px;
            white-space: nowrap;
        }

    /* ê¸°ì¡´ .mobile-nav ìŠ¤íƒ€ì¼ì„ ìˆ˜ì • */
    .mobile-nav {
        display: flex;
        position: fixed;
        flex-direction: column;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        background: white;
        padding: 15px;
        box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        border-radius: 10px 0 0 10px;
    }

    /* ë„¤ë¹„ê²Œì´ì…˜ í•­ëª© ìŠ¤íƒ€ì¼ ìˆ˜ì • */
    .mobile-nav a {
        padding: 12px;
        text-align: left;
        border-right: none;
        border-bottom: 1px solid #ddd;
        text-decoration: none;
        color: #666
    }

    .mobile-nav a:last-child {
        border-bottom: none;
    }

    /* ë„¤ë¹„ê²Œì´ì…˜ ë°” ìš°ìƒë‹¨ì— ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ */
    .nav-logo {
        display: flex;
        align-items: center;
        position: absolute;
        bottom: 30px;
        right: 50px;
    }

        /* íŒì—… ê¸°ë³¸ ìˆ¨ê¹€ */
    .popup {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5); /* ë°˜íˆ¬ëª… ë°°ê²½ */
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }

    /* íŒì—… ë‚´ìš© ìŠ¤íƒ€ì¼ */
    .popup-content {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        text-align: center;
        width: 300px;
        position: relative;
    }

    /* ë‹«ê¸° ë²„íŠ¼ */
    .close {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 20px;
        cursor: pointer;
    }

    /* ë¡œê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
    .logo-img {
        width: 140px; /* ì´ë¯¸ì§€ í¬ê¸° ì„¤ì • */
        height: auto;
        -webkit-user-drag: none;
        -khtml-user-drag: none;
        -moz-user-drag: none;
        -o-user-drag: none;
    }

    /* ë¡œê³  í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .logo-text {
        font-size: 13px; /* í…ìŠ¤íŠ¸ í¬ê¸° */
        font-weight: bold;
        margin-right: 20px; /* ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ì‚¬ì´ ì—¬ë°± */
        color: #f9f9f9; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
    }

    .building-list {
        position: fixed;
        bottom: 0px;
        left: 0;
        right: 0;
        background: white;
        border-radius: 15px 15px 0 0;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        z-index: 999;
        height: 30vh; /* ê³ ì • ë†’ì´ ì„¤ì • */
        display: flex;
        flex-direction: column;
        overflow-y: auto; /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ê²Œ ì„¤ì • */
        -webkit-overflow-scrolling: touch; /* ëª¨ë°”ì¼ì—ì„œ ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ */
    }

.building-container {
    padding: 20px;
}

.building-section {
    margin-bottom: 20px;
}

.building-section h3 {
    margin: 0 0 10px 0;
    color: #333;
    font-size: 16px;
}

.floor-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.floor-item {
    background: #f0f0f0;
    border: none;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    color: #333;
    cursor: pointer;
}

.floor-item:hover {
    background: #e0e0e0;
}

.locations-list {
        margin-top: 10px;
    }
    
    .location-item {
        padding: 8px;
        margin: 4px 0;
        background: #f8f8f8;
        border-radius: 8px;
        font-size: 14px;
        cursor: pointer;
    }
    
    .location-item:hover {
        background: #f0f0f0;
    }

        
    @media (max-width: 768px) {
        /* ëª¨ë°”ì¼ í™”ë©´ì—ì„œëŠ” í•˜ë‹¨ì— í‘œì‹œ */
    .mobile-nav {
        flex-direction: row;
        bottom: 0;
        left: 0;
        right: 0;
        top: auto;
        transform: none;
        padding: 18px 0;
        justify-content: space-around;
        border-radius: 0;
    }

    .mobile-nav a {
        padding: 0px;
        text-align: center;
        flex-grow: 1;
        border-bottom: none;
        border-right: 1px solid #ddd;
    }

            /* ë„¤ë¹„ê²Œì´ì…˜ ë°” ìš°ìƒë‹¨ì— ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ */
    .nav-logo {
        display: flex;
        align-items: center;
        position: absolute;
        bottom: 90px;
        right: 10px;
        -webkit-user-drag: none;
        -khtml-user-drag: none;
        -moz-user-drag: none;
        -o-user-drag: none;
    }

    /* ë¡œê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
    .logo-img {
        width: 130px; /* ì´ë¯¸ì§€ í¬ê¸° ì„¤ì • */
        height: auto;
    }

    /* ë¡œê³  í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .logo-text {
        font-size: 12px; /* í…ìŠ¤íŠ¸ í¬ê¸° */
        font-weight: bold;
        margin-right: 20px; /* ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ì‚¬ì´ ì—¬ë°± */
        color: #f9f9f9; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
    }
    .control-panel {
        position: fixed;
        top: 6px;
        left: 50%;
        width: 100%;
        background: white;
        padding: 10px 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        background: transparent;
        box-shadow: none;
        padding: 30px;
    }

    /* ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ */
.mobile-nav {
    display: flex;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    padding: 18px 0;
    justify-content: space-around;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}

/* ë„¤ë¹„ê²Œì´ì…˜ í•­ëª© ì‚¬ì´ì— êµ¬ë¶„ì„  ì¶”ê°€ */
.mobile-nav a {
    padding: 0px;
    text-align: center;
    flex-grow: 1;
    border-right: 1px solid #ddd; /* í•­ëª© ì‚¬ì´ì— êµ¬ë¶„ì„  */
}

    /* ë§ˆì§€ë§‰ í•­ëª©ì˜ êµ¬ë¶„ì„  ì—†ì• ê¸° */
    .mobile-nav a:last-child {
        border-right: none;
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: #666;
        font-size: 15px;
        gap: 4px;
    }

    
    .filter-group {
        display: none; /* í•„í„° ê·¸ë£¹ ìˆ¨ê¹€ */
    }
    
    .bottom-nav {
        display: block; /* ëª¨ë°”ì¼ì—ì„œë§Œ í‘œì‹œ */
    }
    
    #map-wrapper {
        padding-bottom: 10px; /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë†’ì´ë§Œí¼ ì—¬ë°± */
    }
    
    /* ì¹´í…Œê³ ë¦¬ ìŠ¤í¬ë¡¤ í™œì„±í™” */
    #category-filter {
        display: flex;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        padding: 10px 0;
        gap: 10px;
        width: 86%;
        margin: 0 auto;
    }
    
    #category-filter label {
        flex: 0 0 auto;
        padding: 8px 16px;
        background: #f0f0f0;
        border-radius: 20px;
        white-space: nowrap;
    }

    /* ê²€ìƒ‰ì°½ì„ ì¤‘ì•™ì— ë°°ì¹˜ */
    .search-container {
        background: white;
        border-radius: 8px;
        padding: 10px;
        margin-bottom: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        width: 85%;
        max-width: 800px; /* ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
        margin: 0 auto; /* ìë™ìœ¼ë¡œ ì¢Œìš° ì—¬ë°± */
    }

    .search-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

    .search-input {
        border: none;
        padding: 8px;
        width: 100%;
        font-size: 16px;
    }

    .search-results {
        margin: 0 auto;
        width: 78%; /* ëª¨ë°”ì¼ì—ì„œëŠ” ë¶€ëª¨ ìš”ì†Œ ëŒ€ë¹„ 90% ë„ˆë¹„ */
        font-size: 16px; /* ê°€ë…ì„± ì¦ê°€ */
        left: 10%;
}
    /* ì¹´í…Œê³ ë¦¬ ìŠ¤íƒ€ì¼ */
    #category-filter {
        display: flex;
        gap: 10px;
        overflow-x: auto;
        padding: 10px 0;
        -webkit-overflow-scrolling: touch;
    }

    #category-filter label {
        background: #e155b5;
        color: white;
        padding: 8px 20px;
        border-radius: 20px;
        white-space: nowrap;
        font-size: 14px;
    }

    /* í•˜ë‹¨ ê±´ë¬¼ ì •ë³´ */
    .bottom-info {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: #4267B2;
        color: white;
        padding: 20px;
        border-radius: 15px 15px 0 0;
    }

    .bottom-info div {
        margin: 5px 0;
        font-size: 16px;
    }

    .building-list {
        bottom: 70px;
    }
}

.pin-info-box {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 54%; /* ëª¨ë°”ì¼ í™”ë©´ì—ì„œì˜ ë„ˆë¹„ */
        max-width: 300px;
        z-index: 1002; /* ë‹¤ë¥¸ ìš”ì†Œë“¤ë³´ë‹¤ ìœ„ì— í‘œì‹œ */
    }

    @media (max-width: 480px) {
        /* ì‘ì€ í™”ë©´ì—ì„œ ë¼ë²¨ í¬ê¸° ë° ì…ë ¥ í¬ê¸° ì¡°ì • */
        .search-input {
            font-size: 14px;
            padding: 6px;
        }

        .filter-select {
            font-size: 14px;
            padding: 6px;
        }
    }
    </style>
</head>
<body>
    <div class="control-panel">
        <!-- ê²€ìƒ‰ ì°½ -->
        <div class="search-container">
            <span class="search-title">DIMA MAP</span> <!-- íƒ€ì´í‹€ ì¶”ê°€ -->
            <input type="text" class="search-input" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." id="search-input">
            <div class="search-results" id="search-results"></div>
        </div>

        <!-- í•„í„°ë§ -->
        <div class="filter-group">
            <label for="building-filter">ê±´ë¬¼</label>
            <select id="building-filter" class="filter-select"></select>

            <label for="floor-filter">ì¸µ</label>
            <select id="floor-filter" class="filter-select"></select>
        </div>

        <!-- ì¹´í…Œê³ ë¦¬ í•„í„° -->
        <div id="category-filter">
            <label><input type="checkbox" name="category" value=""> ì „ì²´</label>
            <!-- ë™ì ìœ¼ë¡œ ì¹´í…Œê³ ë¦¬ ë¼ë””ì˜¤ ë²„íŠ¼ ì¶”ê°€ -->
        </div>
    </div>

    <div id="map-wrapper">
        <div id="map-container">
            <img id="map-image" src="map.png" alt="ì§€ë„" draggable="false">
        </div>
    </div>

    <div class="nav-logo">
        <span class="logo-text">3ì›” 1ì£¼ ì „ ë°ì´í„° ê³ ë„í™” ì˜ˆì • / ìœ„ì„± ì œê³µ ã…£ êµ­í† ì§€ë¦¬ì •ë³´ì›</span>
        <img src="sub0705_01_Open_Mark_01.jpg" alt="êµ­í† ì§€ë¦¬ì •ë³´ì›" class="logo-img">
    </div>

    <div class="building-list" style="display: none;">
        <div class="building-container">
            <!-- ê±´ë¬¼ê³¼ ì¸µ ì •ë³´ê°€ ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
        </div>
    </div>

    <nav class="mobile-nav">
        <a href="https://mytwice.github.io/I-DIMA/" class="nav-item">
            <span>ğŸ </span>
            <span>I-DIMA í™ˆ</span>
        </a>
        <a href="#" class="nav-item">
            <span>ğŸ”</span>
            <span>ê±´ë¬¼</span>
        </a>
        <a href="https://www.instagram.com/p/DF4aY0eRXTu/" class="nav-item">
            <span>ğŸ“</span>
            <span>ì›ë£¸ì´Œì§€ë„</span>
        </a>
        <a href="#" class="nav-item" id="openPopup">
            <span>â„¹ï¸</span>
            <span>ì œë³´/ì •ë³´</span>
        </a>
    </nav>

    <!-- íŒì—… ì°½ -->
<div id="popup" class="popup">
    <div class="popup-content">
        <span class="close">&times;</span>
        <h2>ì œë³´/ì •ë³´</h2>
        <p style="word-break: keep-all;">ì •ë³´ëŠ” ëŒ€í•™ í™ˆí˜ì´ì§€ì™€ í‘œì§€íŒì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©° ì˜ëª»ëœ ì •ë³´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
        <p style="word-break: keep-all;">ì˜ëª»ëœ ì •ë³´ë‚˜ ì¶”ê°€í•  ì‚¬í•­ì´ ìˆì„ ê²½ìš°ì— ì–¸ì œë“  ì—°ë½ì£¼ì„¸ìš”!</p>
        <p>ì›í™œí•œ ìš´ì˜ì„ ìœ„í•´ ë„¤ì´ë²„, êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ë¡œ ë°©ë¬¸ì ìˆ˜ ë“±ì„ ì§‘ê³„í•˜ê³  ìˆìŠµë‹ˆë‹¤</p>
        <p>ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ : 2025.02.20</p>
        <p>ì œì‘ : I DIMA í”„ë¡œì íŠ¸</p>
        <a href="https://mytwice.github.io/I-DIMA/service" target="_blank">(ì´ìš©ì•½ê´€ã…£ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨)</a>
    </div>
</div>
</body>

<script>
// ë³€ìˆ˜ ì„ ì–¸
const mapWrapper = document.getElementById('map-wrapper');
const mapContainer = document.getElementById('map-container');
const searchInput = document.getElementById('search-input');
const searchResults = document.getElementById('search-results');
let pins = [];
let isDragging = false;
let startX, startY;
let currentTranslateX = 0, currentTranslateY = 0, currentScale = 1;
let mode = 'move';
let selectedPin = null;
let activeInfoBox = null;
let lastTouchDistance = 0;
let zoomAnimation;
let initialTouchX, initialTouchY;
let isTouchMoving = false;
let lastTouchTime = 0;
const TOUCH_DELAY = 300; // ë”ë¸”íƒ­ ê°ì§€ë¥¼ ìœ„í•œ ì‹œê°„ ê°„ê²© (ms)

// ë§µ ì„¤ì •
const mapConfig = {
    initialScale: 2.6,        // 2.6ì—ì„œ 1.7ë¡œ ë³€ê²½
    initialX: -550,           // 0ì—ì„œ -70ìœ¼ë¡œ ë³€ê²½
    initialY: -630,
    minScale: 1.0,            // 2.5ì—ì„œ 0ìœ¼ë¡œ ë³€ê²½
    maxScale: 9,
    zoomSpeed: 1,
    mobile: {
        initialScale: 1.2,
        initialX: -460,
        initialY: -10
    }
};

// í•€ ë°ì´í„°
const pinsData = [
  {
    "id": "1739338815570",
    "x": "600.26",
    "y": "467.19",
    "building": "ì§€ì„±ê´€",
    "floor": "",
    "category": "",
    "name": "ì§€ì„±ê´€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739354323376",
    "x": "599.82",
    "y": "439.86",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "",
    "category": "",
    "name": "ê¸°ì˜ˆê´€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739338828151",
    "x": "599.21",
    "y": "409.30",
    "building": "ë•ì„±ê´€",
    "floor": "",
    "category": "",
    "name": "ë•ì„±ê´€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739338831348",
    "x": "601.32",
    "y": "492.98",
    "building": "ëŒ€í•™ë³¸ë¶€",
    "floor": "",
    "category": "",
    "name": "ëŒ€í•™ë³¸ë¶€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739338835714",
    "x": "559.21",
    "y": "529.30",
    "building": "ì²´ìœ¡ê´€",
    "floor": "",
    "category": "",
    "name": "ì²´ìœ¡ê´€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739338840600",
    "x": "656.58",
    "y": "510.35",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì²´ìœ¡ì‹œì„¤",
    "name": "ì•¼ì™¸ê³µì—°ì¥",
    "description": "ì˜ˆìˆ ëŒ€í•™ì— ê±¸ë§ëŠ” ëŒ€í˜• ê³µì—°ì„ í• ìˆ˜ ìˆë„ë¡ 1,100ì„ ê·œëª¨ì˜ ì•¼ì™¸ ê³µì—°ì¥ìœ¼ë¡œ ê°ì¢… ì¶•ì œ, ê³µì—°, ë™ì•„ë¦¬ í™œë™ ë“± ëŒ€ê·œëª¨ê³µì—°ì„ ì¤€ë¹„, ì œì‘, ê´€ëŒí•˜ëŠ”ê³³ì…ë‹ˆë‹¤.",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739338860720",
    "x": "615.53",
    "y": "662.63",
    "building": "ì‹œì™¸ë²„ìŠ¤ì •ë¥˜ì†Œ",
    "floor": "",
    "category": "",
    "name": "ì‹œì™¸ë²„ìŠ¤ì •ë¥˜ì¥",
    "description": "ê°•ë‚¨ë°©ë©´ 4402ì™€ ì‹œì™¸ë²„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” ì •ë¥˜ì¥, ì…”í‹€ë²„ìŠ¤ ë¯¸ì •ì°¨",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739338879762",
    "x": "588.16",
    "y": "125.96",
    "building": "ì˜ˆì¸ê´€",
    "floor": "",
    "category": "",
    "name": "ì˜ˆì¸ê´€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739338899793",
    "x": "491.84",
    "y": "235.88",
    "building": "DIMA ì¢…í•©ì´¬ì˜ì†Œ",
    "floor": "",
    "category": "",
    "name": "DIMA ì¢…í•©ì´¬ì˜ì†Œ",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739338938011",
    "x": "556.05",
    "y": "150.61",
    "building": "ì—”í„°í…Œì¸ë¨¼íŠ¸ê´€",
    "floor": "",
    "category": "",
    "name": "ì—”í„°í…Œì¸ë¨¼íŠ¸ê´€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739338940878",
    "x": "532.89",
    "y": "170.09",
    "building": "ë””ìì¸ì„¼í„°",
    "floor": "",
    "category": "",
    "name": "ë””ìì¸ì„¼í„°",
    "description": "",
    "number": "",
    "address": "",
    "priority": "1ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739339088514",
    "x": "622.37",
    "y": "545.35",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì²´ìœ¡ì‹œì„¤",
    "name": "ëŒ€ìš´ë™ì¥",
    "description": "êµ­ì œê·œê²©ì— ì¤€í•˜ëŠ” ì¸ì¡°ì”ë”” êµ¬ì¥ê³¼ ìš°ë ˆíƒ„ íŠ¸ë™, ë†êµ¬ì¥ ë“±ì´ ì¡°ì„±ë˜ì–´ ë‚ ì”¨ì— ìƒê´€ì—†ì´ ì•ˆì „í•˜ê²Œ ì²´ìœ¡í™œë™ì„ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739339150584",
    "x": "678.11",
    "y": "757.50",
    "building": "",
    "floor": "",
    "category": "ì •ë¥˜ì¥",
    "name": "ì›ë£¸ì´Œ ì •ë¥˜ì¥",
    "description": "4402 í•˜ì°¨ì™¸ ë‚´ë¶€ ì…”í‹€ë²„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” ì •ë¥˜ì¥",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739339490339",
    "x": "584.28",
    "y": "519.56",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì •ë¥˜ì¥",
    "name": "ìš´ë™ì¥ ì •ë¥˜ì¥",
    "description": "18ì‹œ ì´í›„ ìš´ì˜í•˜ëŠ” ì •ë¥˜ì¥",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739339524052",
    "x": "588.94",
    "y": "385.78",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì •ë¥˜ì¥",
    "name": "ë•ì„±ê´€ì‚¼ê±°ë¦¬ ì •ë¥˜ì¥",
    "description": "",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739339552981",
    "x": "573.28",
    "y": "168.44",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì •ë¥˜ì¥",
    "name": "ë””ìì¸ì„¼í„° ì •ë¥˜ì¥",
    "description": "",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739339781162",
    "x": "704.06",
    "y": "870.05",
    "building": "",
    "floor": "",
    "category": "ì •ë¥˜ì¥",
    "name": "ë™ì•„ë°©ì†¡ì˜ˆìˆ ëŒ€í•™êµì…êµ¬(ë„ì´Œë°©ë©´)",
    "description": "4402ì™€ ì‹œë‚´ë²„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” ì •ë¥˜ì¥",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739339885231",
    "x": "739.72",
    "y": "867.78",
    "building": "",
    "floor": "",
    "category": "ì •ë¥˜ì¥",
    "name": "ë™ì•„ë°©ì†¡ì˜ˆìˆ ëŒ€í•™êµì…êµ¬(ë¼ì´Œë°©ë©´)",
    "description": "ì´ì²œë°©ë©´ 8203ì™€ ì‹œë‚´ë²„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” ì •ë¥˜ì¥",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739340188989",
    "x": "683.20",
    "y": "191.27",
    "building": "",
    "floor": "",
    "category": "ê²½ë¹„ì‹¤",
    "name": "í›„ë¬¸ê²½ë¹„ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739340233722",
    "x": "644.20",
    "y": "722.60",
    "building": "",
    "floor": "",
    "category": "ê²½ë¹„ì‹¤",
    "name": "ì •ë¬¸ê²½ë¹„ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739340263459",
    "x": "624.20",
    "y": "163.07",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì²´ìœ¡ì‹œì„¤",
    "name": "ë†êµ¬ì¥",
    "description": "",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739340496450",
    "x": "659.87",
    "y": "553.27",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì²´ìœ¡ì‹œì„¤",
    "name": "ë†êµ¬ì¥",
    "description": "",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739340528109",
    "x": "601.20",
    "y": "509.27",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì •ë¥˜ì¥",
    "name": "ëŒ€í•™ë³¸ë¶€ ì •ë¥˜ì¥",
    "description": "Aë…¸ì„ ê³¼ Bë…¸ì„  í™˜ìŠ¹ì´ ê°€ëŠ¥í•œ ì¥ë¥˜ì¥",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739340738053",
    "x": "571.86",
    "y": "493.71",
    "building": "ëŒ€í•™ë³¸ë¶€",
    "floor": "1ì¸µ",
    "category": "ë„ì„œê´€ì‹œì„¤",
    "name": "ë¦¬ë”ìŠ¤ìŠ¤í…Œì´ì…˜",
    "description": "1,2ì¸µì— ê±¸ì¹œ ë„ì„œê´€",
    "number": "031-670-6665",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://lib.dima.ac.kr/"
  },
  {
    "id": "1739340915610",
    "x": "576.02",
    "y": "494.81",
    "building": "ëŒ€í•™ë³¸ë¶€",
    "floor": "1ì¸µ",
    "category": "í™”ì¥ì‹¤",
    "name": "í™”ì¥ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739340949258",
    "x": "568.68",
    "y": "493.49",
    "building": "ëŒ€í•™ë³¸ë¶€",
    "floor": "3ì¸µ",
    "category": "ë„ì„œê´€ì‹œì„¤",
    "name": "ëŸ¬ë‹ë¼ìš´ì§€",
    "description": "ìê¸°ì£¼ë„í•™ìŠµ, í˜‘ì—…, ì†Œí†µ, ë‚˜ëˆ”, ë¹„êµê³¼ í•™ìŠµ í”„ë¡œê·¸ë¨ ìš´ì˜ ë“± ê°€ëŠ¥í•œ ê³µê°„",
    "number": "031-670-6666",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://lib.dima.ac.kr/"
  },
  {
    "id": "1739341081334",
    "x": "612.99",
    "y": "494.19",
    "building": "ëŒ€í•™ë³¸ë¶€",
    "floor": "1ì¸µ",
    "category": "ì „ì‹œì‹œì„¤",
    "name": "20ì£¼ë…„ ê¸°ë…í™€",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739341130039",
    "x": "608.99",
    "y": "491.52",
    "building": "ëŒ€í•™ë³¸ë¶€",
    "floor": "1ì¸µ",
    "category": "í™”ì¥ì‹¤",
    "name": "í™”ì¥ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739341225532",
    "x": "623.32",
    "y": "481.19",
    "building": "",
    "floor": "",
    "category": "",
    "name": "í•œìš¸ë§ˆë‹¹",
    "description": "",
    "number": "",
    "address": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739341251194",
    "x": "625.99",
    "y": "476.52",
    "building": "ì§€ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "í¸ì˜ì‹œì„¤",
    "name": "ì„¸ë¸ì¼ë ˆë¸",
    "description": "",
    "number": "031-672-5731",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739341337517",
    "x": "629.32",
    "y": "478.52",
    "building": "ì§€ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "í¸ì˜ì‹œì„¤",
    "name": "ë¼ê°ì»¤í”¼",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739345098868",
    "x": "622.65",
    "y": "468.56",
    "building": "ì§€ì„±ê´€",
    "floor": "2ì¸µ",
    "category": "í¸ì˜ì‹œì„¤",
    "name": "í•™ìƒì‹ë‹¹",
    "description": "í•™ìƒ ì‹ë‹¹ì€ í•™ìƒ ë° êµì§ì›ë“¤ì˜ ê±´ê°•í•œ ì‹ìƒí™œì„ ìœ„í•´ ì¢…í•©ì‹í’ˆì „ë¬¸ê¸°ì—…ì˜ ì²´ê³„ì ì´ê³  íš¨ìœ¨ì ì¸ ìš´ì˜ì‹œìŠ¤í…œì„ ë„ì…í•˜ì—¬ ì €ë ´í•œ ê°€ê²©, ì–‘ì§ˆì˜ ì‹ì‚¬, ìµœìƒì˜ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.",
    "number": "",
    "address": "20207",
    "priority": "2ìˆœìœ„",
    "link": "https://www.dima.ac.kr/?p=93"
  },
  {
    "id": "1739345155723",
    "x": "621.99",
    "y": "470.23",
    "building": "ì§€ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "",
    "name": "ë™ì•„ì‰¼í„°",
    "description": "ì·¨ì‹ì´ ê°€ëŠ¥í•œ íœ´ê²Œì‹¤",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739345182077",
    "x": "623.99",
    "y": "468.56",
    "building": "ì§€ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "í™”ì¥ì‹¤",
    "name": "í™”ì¥ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739345231639",
    "x": "626.99",
    "y": "470.88",
    "building": "ì§€ì„±ê´€",
    "floor": "3ì¸µ",
    "category": "ê³µì—°ì‹œì„¤",
    "name": "ì½˜ì„œíŠ¸í™€",
    "description": "í•™ìƒë“¤ì´ ì—°ê·¹, ê³µì—°, í•©ì£¼ ë“±ì˜ ë¬´ëŒ€ë¥¼ í¼ì¹˜ëŠ” ì¥ì†Œë¡œ ê°ê°ì˜ ê³µì—°ì„ íŠ¹ì„±ì— ë§ì¶° ì¡°ëª…, ìŒí–¥, LED ë””ìŠ¤í”Œë ˆì´ ì‹œìŠ¤í…œ, ì¤‘ê³„ ë° ì†¡ì¶œ ë“±ì˜ ë‹¤ì–‘í•œ ì¥ë¹„ ì„¸íŒ…ì„ êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë©° DIMA TVì— ë°©ì˜ ì¤‘ì¸ í™”ìš”ì½˜ì„œíŠ¸ ì œì‘ì„ í•˜ëŠ” ê³µê°„",
    "number": "",
    "address": "20317",
    "priority": "2ìˆœìœ„",
    "link": "https://www.dima.ac.kr/?p=140"
  },
  {
    "id": "1739345324835",
    "x": "606.65",
    "y": "468.88",
    "building": "ì§€ì„±ê´€",
    "floor": "2ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "êµë¬´ì²˜/í–‰ì •ë³µì§€ì²˜",
    "description": "ì§€ì„±ê´€ 2ì¸µ 20205í˜¸",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739345423636",
    "x": "615.65",
    "y": "468.88",
    "building": "ì§€ì„±ê´€",
    "floor": "2ì¸µ",
    "category": "",
    "name": "ìš°ë¦¬ì€í–‰ ì¶œì¥ì†Œ",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739345626416",
    "x": "596.99",
    "y": "469.25",
    "building": "ì§€ì„±ê´€",
    "floor": "2ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "ì…í•™ê´€ë¦¬íŒ€/ì›ê²©ì§€ì›ì„¼í„°",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739345672691",
    "x": "585.32",
    "y": "469.58",
    "building": "ì§€ì„±ê´€",
    "floor": "2ì¸µ",
    "category": "í•™ìƒì§€ì›ì‹œì„¤",
    "name": "ê±´ê°•ê´€ë¦¬ì‹¤",
    "description": "ì´ìš©ëŒ€ìƒ : ì¬í•™ìƒ ë° êµì§ì›\nì´ìš©ì‹œê°„ : ì›”~ê¸ˆ 09:00 ~ 18:00(ë°©í•™ ì¤‘ ë‹¨ì¶•ê·¼ë¬´ì— ì¤€í•¨)\nì ì‹¬ì‹œê°„ : 12:00 ~ 13:00",
    "number": "031-670-6667",
    "address": "20202",
    "priority": "2ìˆœìœ„",
    "link": "https://www.dima.ac.kr/?p=95"
  },
  {
    "id": "1739345764202",
    "x": "562.99",
    "y": "535.90",
    "building": "ì²´ìœ¡ê´€",
    "floor": "1ì¸µ",
    "category": "í™”ì¥ì‹¤",
    "name": "í™”ì¥ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739346547231",
    "x": "617.86",
    "y": "468.95",
    "building": "ì§€ì„±ê´€",
    "floor": "2ì¸µ",
    "category": "í•™ìƒì§€ì›ì‹œì„¤",
    "name": "ë¬´ì¸ ì¦ëª… ë°œê¸‰ê¸°",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739346707657",
    "x": "585.40",
    "y": "467.73",
    "building": "ì§€ì„±ê´€",
    "floor": "4ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "í•™ê³¼ì‚¬ë¬´ì‹¤(ì°½ì˜êµì–‘í•™ë¶€, ê´‘ê³ í¬ë¦¬ì—ì´í‹°ë¸Œê³¼, ë°©ì†¡ì½˜í…ì¸ ì œì‘ê³¼, ë°©ì†¡ì½˜í…ì¸ ì œì‘í•™ê³¼(ì „ê³µì‹¬í™”)",
    "description": "ì°½ì˜êµì–‘í•™ë¶€, ê´‘ê³ í¬ë¦¬ì—ì´í‹°ë¸Œê³¼, ë°©ì†¡ì½˜í…ì¸ ì œì‘ê³¼, ë°©ì†¡ì½˜í…ì¸ ì œì‘í•™ê³¼(ì „ê³µì‹¬í™”)",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": ""
  },
  {
    "id": "1739346862686",
    "x": "597.40",
    "y": "468.73",
    "building": "ì§€ì„±ê´€",
    "floor": "4ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "êµìœ¡í˜ì‹ ì„¼í„°",
    "description": "êµìˆ˜í•™ìŠµì—­ëŸ‰íŒ€, ìœµë³µí•©êµìœ¡íŒ€",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://www.instagram.com/dima_ctl/"
  },
  {
    "id": "1739346940087",
    "x": "633.07",
    "y": "485.73",
    "building": "ì§€ì„±ê´€",
    "floor": "4ì¸µ",
    "category": "ê¸°ê´€ì‚¬ë¬´ì‹¤",
    "name": "ì´í•™ìƒíšŒ",
    "description": "ì¥ì†Œ í™•ì¸ í›„ ì´ë™ ì˜ˆì •",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://www.instagram.com/dima_sisun_28/"
  },
  {
    "id": "1739346993610",
    "x": "609.40",
    "y": "469.07",
    "building": "ì§€ì„±ê´€",
    "floor": "3ì¸µ",
    "category": "ê¸°ê´€ì‚¬ë¬´ì‹¤",
    "name": "ë¯¸ë””ì–´ì„¼í„°(ì‹ ë¬¸ì‚¬)",
    "description": "20315 PRESS ì‹ ë¬¸ì‚¬ ì‚¬ë¬´ì‹¤",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://www.instagram.com/press_dima/"
  },
  {
    "id": "1739347224438",
    "x": "589.88",
    "y": "469.18",
    "building": "ì§€ì„±ê´€",
    "floor": "3ì¸µ",
    "category": "êµìˆ˜ì—°êµ¬ì‹¤",
    "name": "ê°•ì‚¬ì—°êµ¬ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739347457667",
    "x": "628.88",
    "y": "488.45",
    "building": "ì§€ì„±ê´€",
    "floor": "4ì¸µ",
    "category": "ê¸°ê´€ì‚¬ë¬´ì‹¤",
    "name": "ëŒ€ì˜ì›íšŒ",
    "description": "ì¥ì†Œ í™•ì¸ í›„ ì´ë™ ì˜ˆì •",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://www.instagram.com/dima_representative_28th/"
  },
  {
    "id": "1739347461841",
    "x": "635.21",
    "y": "483.12",
    "building": "ì§€ì„±ê´€",
    "floor": "4ì¸µ",
    "category": "ê¸°ê´€ì‚¬ë¬´ì‹¤",
    "name": "ë™ì•„ë¦¬ì—°í•©íšŒ",
    "description": "ì¥ì†Œ í™•ì¸ í›„ ì´ë™ ì˜ˆì •",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://www.instagram.com/dimawa_28th/"
  },
  {
    "id": "1739347609863",
    "x": "575.88",
    "y": "462.45",
    "building": "ì§€ì„±ê´€",
    "floor": "4ì¤‘ì¸µ",
    "category": "",
    "name": "ì¤‘ì¸µ êµìˆ˜ì—°êµ¬ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739347630654",
    "x": "580.21",
    "y": "467.79",
    "building": "ì§€ì„±ê´€",
    "floor": "4ì¤‘ì¸µ",
    "category": "ê°œë°©ì—´ëŒì‹¤",
    "name": "24ì‹œê°„ ê°œë°© ììœ ì—´ëŒì‹¤",
    "description": "20ì¤‘08",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://lib.dima.ac.kr/Common?html=/Users/Dacl/Docs/subguide01.cshtml"
  },
  {
    "id": "1739347801985",
    "x": "584.88",
    "y": "468.79",
    "building": "ì§€ì„±ê´€",
    "floor": "5ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "í•™ê³¼ì‚¬ë¬´ì‹¤(ì—°ê·¹ê³¼, ë””ì§€í„¸ì˜ìƒë””ìì¸ê³¼)",
    "description": "ì—°ê·¹ê³¼, ë””ì§€í„¸ì˜ìƒë””ìì¸ê³¼",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739347863756",
    "x": "580.54",
    "y": "468.12",
    "building": "ì§€ì„±ê´€",
    "floor": "5ì¸µ",
    "category": "ê°œë°©ì—´ëŒì‹¤",
    "name": "24ì‹œê°„ ê°œë°© ììœ ì—´ëŒì‹¤",
    "description": "20509",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„",
    "link": "https://lib.dima.ac.kr/Common?html=/Users/Dacl/Docs/subguide01.cshtml"
  },
  {
    "id": "1739347928176",
    "x": "602.54",
    "y": "469.12",
    "building": "ì§€ì„±ê´€",
    "floor": "5ì¸µ",
    "category": "ê°•ì˜ì‹¤",
    "name": "511~513 ê°•ì˜ì‹¤",
    "description": "ì¶”í›„ ì„¸ë¶€ ì…ë ¥",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739347963714",
    "x": "634.54",
    "y": "485.45",
    "building": "ì§€ì„±ê´€",
    "floor": "5ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "ë¦¬í—ˆì„¤ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739348009311",
    "x": "635.54",
    "y": "486.12",
    "building": "ì§€ì„±ê´€",
    "floor": "3ì¸µ",
    "category": "ë™ì•„ë¦¬ì‹¤",
    "name": "ë™ì•„ë¦¬ì‹¤",
    "description": "ì¶”í›„ ì„¸ë¶€ ì…ë ¥",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739348056937",
    "x": "598.88",
    "y": "466.79",
    "building": "ì§€ì„±ê´€",
    "floor": "6ì¸µ",
    "category": "",
    "name": "ì§€ì„±ê´€ 6ì¸µ ì¶”í›„ ì…ë ¥",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739348411396",
    "x": "610.88",
    "y": "656.85",
    "building": "ì‹œì™¸ë²„ìŠ¤ì •ë¥˜ì†Œ",
    "floor": "1ì¸µ",
    "category": "í™”ì¥ì‹¤",
    "name": "í™”ì¥ì‹¤",
    "description": "",
    "number": "",
    "address": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739348634444",
    "x": "600.21",
    "y": "442.06",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "1ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "í‰ìƒêµìœ¡ì›",
    "description": "ë™ì•„ë°©ì†¡ì˜ˆìˆ ëŒ€í•™êµ í‰ìƒêµìœ¡ì›ì€ ì„±ì¸í•™ìŠµìë¥¼ ëŒ€ìƒìœ¼ë¡œ ë‹¤ì–‘í•œ í‰ìƒêµìœ¡í”„ë¡œê·¸ë¨ì„ ê°œë°œâ€§ìš´ì˜í•˜ê³  ìˆìœ¼ë©°, í‰ìƒêµìœ¡ í”„ë¡œê·¸ë¨ ì œê³µì„ í†µí•´ ê°œì¸ì˜ ì‚¶ì˜ ì§ˆì„ í–¥ìƒì‹œí‚¤ê³ , ìì•„ì‹¤í˜„ì„ ë‹¬ì„±í•˜ë„ë¡ ë„ì›€ì„ ì£¼ê³  ìˆìŠµë‹ˆë‹¤.",
    "number": "",
    "address": "30105",
    "priority": "2ìˆœìœ„",
    "link": "https://lifelong.dima.ac.kr/"
  },
  {
    "id": "1739348683407",
    "x": "625.21",
    "y": "436.73",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "1ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "VIRTUAL ìŠ¤íŠœë””ì˜¤",
    "description": "VR(Virtual Reality, ê°€ìƒí˜„ì‹¤), AR(Augmented Reality, ì¦ê°•í˜„ì‹¤), MR(Mixed Reality, í˜¼í•©í˜„ì‹¤), XR(Extended Realit, í™•ì¥í˜„ì‹¤) ëª¨ì…˜ì¸ì‹ ë“±ê³¼ ê°™ì€ íŠ¹ìˆ˜ ì´¬ì˜ì— ì í•©í•œ ìŠ¤íŠœë””ì˜¤ ì´ë©° VizRT, Aximmetry ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ VIRTUAL ì˜ìƒì œì‘ ë° í¬ë¡œë§ˆí‚¤ í•©ì„±ì‘ì—…ì´ ê°€ëŠ¥í•œ ì‹¤ìŠµì‹¤",
    "number": "",
    "address": "30120",
    "priority": "2ìˆœìœ„",
    "link": "https://www.dima.ac.kr/?p=134"
  },
  {
    "id": "1739348722021",
    "x": "639.88",
    "y": "448.40",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "1ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "HDTV ìŠ¤íŠœë””ì˜¤",
    "description": "ëŒ€í•™ì— ìˆëŠ” TV ìŠ¤íŠœë””ì˜¤ë¡œëŠ” ì œì¼ í° ê·œëª¨ë¡œ ì¹´ë©”ë¼ ì´ë™ì´ ììœ ë¡œì›Œ ë‹¤ì–‘í•œ êµ¬ë„ì˜ ì´¬ì˜ì´ ê°€ëŠ¥í•˜ë©° ì†Œê·œëª¨ ì‡¼ì¼€ì´ìŠ¤, ì„¸íŠ¸ ì´¬ì˜ ë“±ì„ HDë¡œ ì´¬ì˜, ì œì‘, ì†¡ì¶œ, í¸ì§‘ì´ ê°€ëŠ¥í•œ ì‹¤ìŠµì‹¤ì´ë‹¤.",
    "number": "",
    "address": "30111",
    "priority": "2ìˆœìœ„",
    "link": "https://www.dima.ac.kr/?p=133"
  },
  {
    "id": "1739348741359",
    "x": "632.88",
    "y": "442.73",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "1ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "UHD ìŠ¤íŠœë””ì˜¤",
    "description": "ì‹¤ì œ ë°©ì†¡êµ­ê³¼ ìœ ì‚¬í•˜ê²Œ ê¾¸ë©°ì§„ êµ­ë‚´ ëŒ€í•™ê¸°ê´€ ìµœì´ˆì˜ UHDTV ìŠ¤íŠœë””ì˜¤ë¡œ 4K ì¹´ë©”ë¼ë¥¼ ì‚¬ìš©í•˜ì—¬ 4K-12G, 2160 60P ì˜ìƒë¬¼ì˜ ì´¬ì˜ ë° ì œì‘, ì†¡ì¶œê¹Œì§€ í•  ìˆ˜ ìˆëŠ” ì‹¤ìŠµì‹¤",
    "number": "",
    "address": "30122",
    "priority": "2ìˆœìœ„",
    "link": "https://www.dima.ac.kr/?p=132"
  },
  {
    "id": "1739348911946",
    "x": "605.88",
    "y": "437.73",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "1ì¸µ",
    "category": "í•™ìƒì§€ì›ì‹œì„¤",
    "name": "ì°½ì˜ì‹¤ìŠµì§€ì›ì„¼í„°",
    "description": "ìš´ì˜ ì‹œê°„ : 09:00 â€“ 21:00 (ê³µíœ´ì¼ ì „ë‚  09:00 â€“ 19:00)\n  * ì ì‹¬ì‹œê°„ : 12:00 â€“ 13:00 ìˆ˜ì—… ê´€ë ¨ ì—…ë¬´ í•œì • ìš´ì˜",
    "number": "031-670-6635",
    "address": "https://www.dima.ac.kr/?p=111&viewMode=view&reqIdx=2408220917215498",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739351782823",
    "x": "584.83",
    "y": "441.52",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "í•™ê³¼ì‚¬ë¬´ì‹¤(ë°©ì†¡ê·¹ì‘ê³¼, ì˜ìƒì œì‘ê³¼)",
    "address": "",
    "description": "ë°©ì†¡ê·¹ì‘ê³¼, ì˜ìƒì œì‘ê³¼",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739351874304",
    "x": "642.16",
    "y": "448.86",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "2ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "HDTV ì¡°ì •ì‹¤",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739351882399",
    "x": "642.16",
    "y": "453.19",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "2ì¸µ",
    "category": "",
    "name": "FMë°©ì†¡êµ­",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739352757560",
    "x": "605.49",
    "y": "441.52",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "2ì¸µ",
    "category": "",
    "name": "ì˜¨íƒíŠ¸ ìŠ¤íŠœë””ì˜¤",
    "address": "30212",
    "description": "ë¹„ëŒ€ë©´ì„ ì¼ì»«ëŠ” Untactì— ì˜¨ë¼ì¸ì„ í†µí•œ ì™¸ë¶€ì™€ì˜ ì—°ê²°(On)ì„ ë”í•œ ê°œë…ìœ¼ë¡œ ë¹„ëŒ€ë©´ ê°•ì˜ ë“±ê³¼ ê°™ì€ êµìœ¡ ì½˜í…ì¸ ë¥¼ ë§Œë“¤ê³  1ì¸ ë°©ì†¡ ìˆ˜ì—… ë° ì œì‘ì— ìµœì í™”ëœ ì‹¤ìŠµì‹¤",
    "number": "",
    "link": "https://www.dima.ac.kr/?p=139",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739352858154",
    "x": "588.49",
    "y": "441.86",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "2ì¸µ",
    "category": "ê°œë°©ì—´ëŒì‹¤",
    "name": "24ì‹œê°„ ê°œë°© ììœ ì—´ëŒì‹¤",
    "address": "30209",
    "description": "",
    "number": "",
    "link": "https://lib.dima.ac.kr/Common?html=/Users/Dacl/Docs/subguide01.cshtml",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739352968920",
    "x": "590.49",
    "y": "441.52",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¸µ",
    "category": "",
    "name": "24ì‹œê°„ ê°œë°© ììœ ì—´ëŒì‹¤",
    "address": "30309",
    "description": "",
    "number": "",
    "link": "https://lib.dima.ac.kr/Common?html=/Users/Dacl/Docs/subguide01.cshtml",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739352995836",
    "x": "590.83",
    "y": "442.19",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "4ì¸µ",
    "category": "ê°œë°©ì—´ëŒì‹¤",
    "name": "24ì‹œê°„ ê°œë°© ììœ ì—´ëŒì‹¤",
    "address": "30409",
    "description": "",
    "number": "",
    "link": "https://lib.dima.ac.kr/Common?html=/Users/Dacl/Docs/subguide01.cshtml",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739353352573",
    "x": "584.82",
    "y": "441.94",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¤‘ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "í•™ê³¼ì‚¬ë¬´ì‹¤(ë°©ì†¡ê¸°ìˆ ê³¼, ë°©ì†¡ê¸°ìˆ í•™ê³¼, ë‰´ë¯¸ë””ì–´ì½˜í…ì¸ ê³¼)",
    "address": "30ì¤‘08",
    "description": "í•™ê³¼ì‚¬ë¬´ì‹¤(ë°©ì†¡ê¸°ìˆ ê³¼, ë°©ì†¡ê¸°ìˆ í•™ê³¼, ë‰´ë¯¸ë””ì–´ì½˜í…ì¸ ê³¼)",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739353503233",
    "x": "585.16",
    "y": "441.94",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "4ì¸µ",
    "category": "í–‰ì •ì‹œì„¤",
    "name": "í•™ê³¼ì‚¬ë¬´ì‹¤(ìŒí–¥ì œì‘ê³¼, ìŒí–¥ì œì‘í•™ê³¼, ì—°ê¸°ì˜ˆìˆ í•™ê³¼, ì½˜í…ì¸ ì œì‘í•™ê³¼, ë¬¸í™”ì˜ˆìˆ ë§ˆì¼€íŒ…í•™ê³¼)",
    "address": "",
    "description": "í•™ê³¼ì‚¬ë¬´ì‹¤(ìŒí–¥ì œì‘ê³¼, ìŒí–¥ì œì‘í•™ê³¼, ì—°ê¸°ì˜ˆìˆ í•™ê³¼, ì½˜í…ì¸ ì œì‘í•™ê³¼, ë¬¸í™”ì˜ˆìˆ ë§ˆì¼€íŒ…í•™ê³¼)",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739353582585",
    "x": "595.82",
    "y": "438.94",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "5ì¸µ",
    "category": "",
    "name": "ì¶”í›„ ì…ë ¥",
    "address": "",
    "description": "ì¶”í›„ ì…ë ¥",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739353625531",
    "x": "638.49",
    "y": "451.27",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¸µ",
    "category": "ê¸°ê´€ì‚¬ë¬´ì‹¤",
    "name": "ëŒ€í•™ë°©ì†¡êµ­ DBS",
    "address": "",
    "description": "ëŒ€í•™ë°©ì†¡êµ­ DBS ì‚¬ë¬´ì‹¤",
    "number": "",
    "link": "https://www.instagram.com/pride_of_dima/",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739353734170",
    "x": "640.49",
    "y": "444.52",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "ê°œë°©í¸ì§‘ì‹¤1",
    "address": "30323",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739357813305",
    "x": "627.98",
    "y": "435.76",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¸µ",
    "category": "í•™ìƒì§€ì›ì‹œì„¤",
    "name": "ê¸€ë¡œë²Œë¼ìš´ì§€/K-WAVEí•œêµ­ì–´êµìœ¡ì›",
    "address": "30324",
    "description": "ì™¸êµ­ì¸ ìœ í•™ìƒì˜ ì•ˆì •ì ì¸ êµë‚´ìƒí™œ ì ì‘ ë° ì§€ì›ì„ ìœ„í•´ ë§ˆë ¨ëœ ê³µê°„ìœ¼ë¡œì„œ, ê¸€ë¡œë²Œì—˜ë¦¬íŠ¸í•™ìƒë‹¨ ë° ê¸€ë¡œë²Œë¼ìš´ì§€ ì „ë‹´ì¡°êµ ì£¼ê´€ ë©˜í† ë§ í”„ë¡œê·¸ë¨, ê°„ë‹´íšŒ, ë¬¸í™”ì²´í—˜ í”„ë¡œê·¸ë¨ ë“±ì„ ìš´ì˜",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739353922806",
    "x": "624.82",
    "y": "442.86",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¸µ",
    "category": "í•™ìƒì§€ì›ì‹œì„¤",
    "name": "ëŒ€í•™ì¸ê¶Œì„¼í„°",
    "address": "30315",
    "description": "",
    "number": "",
    "link": "https://www.dima.ac.kr/?p=96",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739357994649",
    "x": "632.98",
    "y": "440.10",
    "building": "ê¸°ì˜ˆê´€",
    "floor": "3ì¸µ",
    "category": "í•™ìƒì§€ì›ì‹œì„¤",
    "name": "ì°½ì—…ë¼ìš´ì§€",
    "address": "30325",
    "description": "ì°½ì—…ë¼ìš´ì§€ëŠ” í•™ìƒë“¤ì˜ ì·¨ì—…ê³¼ ì°½ì—…ì„ ìœ„í•œ ê³µê°„ìœ¼ë¡œì¨ ë‹¤ì–‘í•œ ì·¨Â·ì°½ì—…ì •ë³´ ì œê³µ ë° í”„ë¡œê·¸ë¨ ìš´ì˜ê³¼ ì§„ë¡œê³ ë¯¼ë¶€í„° ì·¨Â·ì°½ì—…ìƒë‹´ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ê³µê°„",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739354758528",
    "x": "578.83",
    "y": "410.90",
    "building": "ë•ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "ê³µì—°ì‹œì„¤",
    "name": "ë“œë¼ë§ˆ ìŠ¤í˜ì´ìŠ¤",
    "address": "50101",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739356558319",
    "x": "620.83",
    "y": "403.91",
    "building": "ë•ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "ê°œì¸ì—°ìŠµì‹¤",
    "address": "50108",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739357199036",
    "x": "628.90",
    "y": "457.89",
    "building": "",
    "floor": "",
    "category": "",
    "name": "êµ¬ë¦„ë‹¤ë¦¬",
    "address": "",
    "description": "ì§€ì„±ê´€ 3ì¸µâ†”ê¸°ì˜ˆê´€ 1ì¸µ",
    "number": "",
    "link": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739357205340",
    "x": "588.90",
    "y": "453.89",
    "building": "",
    "floor": "",
    "category": "",
    "name": "êµ¬ë¦„ë‹¤ë¦¬",
    "address": "",
    "description": "ì§€ì„±ê´€ 4ì¸µâ†”ê¸°ì˜ˆê´€ 2ì¸µ",
    "number": "",
    "link": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739357207921",
    "x": "588.90",
    "y": "425.23",
    "building": "",
    "floor": "",
    "category": "",
    "name": "êµ¬ë¦„ë‹¤ë¦¬",
    "address": "",
    "description": "ê¸°ì˜ˆê´€ 3ì¸µâ†”ë•ì„±ê´€ 2ì¸µ",
    "number": "",
    "link": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739357209907",
    "x": "596.57",
    "y": "395.23",
    "building": "",
    "floor": "",
    "category": "",
    "name": "êµ¬ë¦„ë‹¤ë¦¬",
    "address": "",
    "description": "ë•ì„±ê´€ 3.5ì¸µâ†”ì‚¼ê±°ë¦¬",
    "number": "",
    "link": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739357399774",
    "x": "577.90",
    "y": "411.07",
    "building": "ë•ì„±ê´€",
    "floor": "4ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "C3 ìŠ¤íŠœë””ì˜¤",
    "address": "50402",
    "description": "Creativity, Convergence, Contentsë¥¼ ì˜ë¯¸í•˜ëŠ” ìœµí•© ìˆ˜ì—… ì „ìš© ìŠ¤íŠœë””ì˜¤ì´ë©° ì—¬ëŸ¬ í•™ê³¼ í•™ìƒë“¤ì´ ê¸°ìˆ , ì¹´ë©”ë¼, ìŒí–¥, ì¡°ëª…, ì„¸íŠ¸ì œì‘, ì†¡ì¶œ íŒŒíŠ¸ ë“±ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì½˜í…ì¸ ë¥¼ ì œì‘, ê²°ê³¼ë¬¼ì„ DIMA TVì— ë°©ì˜í•  ìˆ˜ ìˆë„ë¡ ê°–ì¶”ì–´ì§„ ì‹¤ìŠµì‹¤",
    "number": "",
    "link": "https://www.dima.ac.kr/?p=135",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739357545369",
    "x": "581.24",
    "y": "411.15",
    "building": "ë•ì„±ê´€",
    "floor": "2ì¸µ",
    "category": "ê³µì—°ì‹œì„¤",
    "name": "ì†Œê·¹ì¥",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739358292228",
    "x": "565.65",
    "y": "799.08",
    "building": "",
    "floor": "",
    "category": "",
    "name": "Aì´Œ",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739358319438",
    "x": "768.14",
    "y": "807.27",
    "building": "",
    "floor": "",
    "category": "",
    "name": "Bì´Œ",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739358335861",
    "x": "717.32",
    "y": "700.19",
    "building": "",
    "floor": "",
    "category": "",
    "name": "Cì´Œ",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "1ìˆœìœ„"
  },
  {
    "id": "1739358778828",
    "x": "631.30",
    "y": "479.99",
    "building": "ì§€ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "í¸ì˜ì‹œì„¤",
    "name": "Barunson",
    "address": "",
    "description": "í•œìš¸ë§ˆë‹¹ ë¬¸êµ¬ì ",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739359019117",
    "x": "632.30",
    "y": "485.24",
    "building": "ì§€ì„±ê´€",
    "floor": "1ì¸µ",
    "category": "ì²´ìœ¡ì‹œì„¤",
    "name": "í”¼íŠ¸ë‹ˆìŠ¤ ì„¼í„°",
    "address": "",
    "description": "í”¼íŠ¸ë‹ˆìŠ¤ì„¼í„°ëŠ” í•™ìƒ ë° êµì§ì›ì˜ ê±´ê°•ì¦ì§„ ë° ì²´ë ¥í–¥ìƒì„ ìœ„í•œ ì‹œì„¤ë¡œ, ëŸ¬ë‹ë¨¸ì‹  Â· íŒŒì›Œë™ Â· í”„ë ˆìŠ¤ë¨¸ì‹  Â· ì¼€ì´ë¸”ë¨¸ì‹  Â· ë¡±í’€ë¨¸ì‹ , ì¹˜ë‹ë””í•‘ ë“± ë‹¤ì–‘í•œ ìš´ë™ê¸°êµ¬ë¥¼ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤. í•™ìƒíšŒê´€ 1ì¸µì— ìœ„ì¹˜í•˜ë©°, ë†êµ¬, ì¶•êµ¬, ë°°êµ¬, ë°°ë“œë¯¼í„´ì„ ìœ„í•œ êµ¬ê¸°ìš©í’ˆê³¼ ë¼ì¼“, ë„¤íŠ¸ ë“±ë„ ëŒ€ì—¬ê°€ëŠ¥",
    "number": "031-670-6536",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739359683418",
    "x": "560.60",
    "y": "140.93",
    "building": "ì—”í„°í…Œì¸ë¨¼íŠ¸ê´€",
    "floor": "2ì¸µ",
    "category": "ê³µì—°ì‹œì„¤",
    "name": "ëŒ€ê³µì—°ì¥",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739359736395",
    "x": "550.93",
    "y": "160.60",
    "building": "ì—”í„°í…Œì¸ë¨¼íŠ¸ê´€",
    "floor": "1ì¸µ",
    "category": "ì „ì‹œì‹œì„¤",
    "name": "DIMAì•„íŠ¸ì„¼í„°",
    "address": "",
    "description": "DIMA ì•„íŠ¸ì„¼í„°ëŠ” ê¸°íšì „ê³¼ ê°œì¸ì „ì„ í†µí•´ ëŒ€í•™ ì†Œì¥í’ˆ ë° êµ­ë‚´ì™¸ ìœ ìˆ˜í•œ ì‘ê°€ë“¤ì˜ ì‘í’ˆ, ì „ì‹œ ì›”~í†  9:00 ~ 18:00, ì¼ìš”ì¼ ë° ê³µíœ´ì¼ íœ´ê´€",
    "number": "031-670-6938",
    "link": "https://art.dima.ac.kr/",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739359862452",
    "x": "600.23",
    "y": "132.26",
    "building": "ì˜ˆì¸ê´€",
    "floor": "B1ì¸µ",
    "category": "í¸ì˜ì‹œì„¤",
    "name": "GS25",
    "address": "",
    "description": "ì™¸ë¶€ì¸ ì´ìš©ê°€ëŠ¥í•œ ì˜ˆì¸ê´€ ì§€í•˜ì— ìœ„ì¹˜í•œ 24ì‹œê°„ í¸ì˜ì ",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739359932028",
    "x": "599.23",
    "y": "126.26",
    "building": "ì˜ˆì¸ê´€",
    "floor": "1ì¸µ",
    "category": "í¸ì˜ì‹œì„¤",
    "name": "ê¸°ìˆ™ì‚¬ ì‹ë‹¹",
    "address": "",
    "description": "ì™¸ë¶€ì¸ë„ ì´ìš© ê°€ëŠ¥í•œ ì‹ë‹¹",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739360087827",
    "x": "572.00",
    "y": "593.71",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì „ì‹œì‹œì„¤",
    "name": "10ì£¼ë…„ê¸°ë…ì¡°í˜•ë¬¼",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739360120064",
    "x": "586.60",
    "y": "503.30",
    "building": "",
    "floor": "ì‹¤ì™¸",
    "category": "ì „ì‹œì‹œì„¤",
    "name": "20ì£¼ë…„ê¸°ë…ì¡°í˜•ë¬¼",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "3ìˆœìœ„"
  },
  {
    "id": "1739360254929",
    "x": "504.44",
    "y": "212.30",
    "building": "DIMA ì¢…í•©ì´¬ì˜ì†Œ",
    "floor": "1ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "1ìŠ¤íŠœë””ì˜¤",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739360257936",
    "x": "486.44",
    "y": "224.97",
    "building": "DIMA ì¢…í•©ì´¬ì˜ì†Œ",
    "floor": "1ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "3ìŠ¤íŠœë””ì˜¤",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739360260620",
    "x": "468.78",
    "y": "237.63",
    "building": "DIMA ì¢…í•©ì´¬ì˜ì†Œ",
    "floor": "1ì¸µ",
    "category": "ì‹¤ìŠµì‹¤",
    "name": "2ìŠ¤íŠœë””ì˜¤",
    "address": "",
    "description": "",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  },
  {
    "id": "1739360392972",
    "x": "563.19",
    "y": "152.30",
    "building": "ì—”í„°í…Œì¸ë¨¼íŠ¸ê´€",
    "floor": "1ì¸µ",
    "category": "í¸ì˜ì‹œì„¤",
    "name": "ë¸”ë£¨í¬íŠ¸",
    "address": "",
    "description": "1ì¸µì— ìœ„ì¹˜í•œ ì¹´í˜",
    "number": "",
    "link": "",
    "priority": "2ìˆœìœ„"
  }
]

// í•„í„° ì˜µì…˜ ì´ˆê¸°í™” í•¨ìˆ˜
function initializeFilterOptions() {
    const buildingFilter = document.getElementById('building-filter');
    const floorFilter = document.getElementById('floor-filter');
    const categoryFilter = document.getElementById('category-filter');

    const buildings = [...new Set(pinsData.map(pin => pin.building))];
    const floors = [...new Set(pinsData.map(pin => pin.floor))];
    const categories = [...new Set(pinsData.map(pin => pin.category))];

    // í•„í„° ì˜µì…˜ ì±„ìš°ê¸°
    function populateFilter(filter, options, type = 'select') {
        if (type === 'checkbox') {
            filter.innerHTML = ''; // ê¸°ì¡´ ì½˜í…ì¸  ì´ˆê¸°í™”
            options.forEach(option => {
                if (option) {
                    const label = document.createElement('label');
                    label.innerHTML = `<input type="checkbox" name="category" value="${option}">${option}</label>`;
                    filter.appendChild(label);
                }
            });
        } else {
            filter.innerHTML = '<option value="">ì „ì²´</option>';
            options.forEach(option => {
                if (option) {
                    filter.innerHTML += `<option value="${option}">${option}</option>`;
                }
            });
        }
    }

    populateFilter(buildingFilter, buildings);
    populateFilter(floorFilter, floors);
    populateFilter(categoryFilter, categories, 'checkbox');
}

// ê²€ìƒ‰ ê¸°ëŠ¥
searchInput.addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase();
    if (searchTerm.length < 1) {
        searchResults.style.display = 'none';
        return;
    }

    // name, building, description, addressë¥¼ ê²€ìƒ‰ì–´ì— í¬í•¨í•˜ëŠ”ì§€ ì²´í¬
    const filteredPins = pinsData.filter(pin => 
        pin.name.toLowerCase().includes(searchTerm) ||
        pin.building.toLowerCase().includes(searchTerm) ||
        pin.description.toLowerCase().includes(searchTerm) ||
        (pin.address && pin.address.toLowerCase().includes(searchTerm))
    );

    searchResults.innerHTML = '';
    if (filteredPins.length > 0) {
        filteredPins.forEach(pin => {
            const resultItem = document.createElement('div');
            resultItem.className = 'search-result-item';
            resultItem.innerHTML = `
                <div><strong>${pin.name}</strong></div>
                <div>${pin.building} ${pin.floor}</div>
                <div>${pin.address}</div>
            `;
            resultItem.addEventListener('click', () => {
                const pinObj = pins.find(p => 
                    p.coordinates.x === pin.x && 
                    p.coordinates.y === pin.y
                );

                if (pinObj) {
                    pinObj.pin.style.display = 'block'; // í•€ ê°•ì œ í‘œì‹œ
                    moveToPin(pinObj.pin);
                    showPinInfoBox(pinObj.pin, pin);
                }

                // ê²€ìƒ‰ ê²°ê³¼ ìœ ì§€
                searchResults.style.display = 'block';
            });
            searchResults.appendChild(resultItem);
        });
        searchResults.style.display = 'block';
    } else {
        searchResults.style.display = 'none';
    }
});

// ê²€ìƒ‰ ê²°ê³¼ì™€ ì¼ì¹˜í•˜ëŠ” í•€ë§Œ ë³´ì´ê²Œ í•˜ê¸°
function filterPinsBySearch() {
    const searchTerm = searchInput.value.toLowerCase(); // ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°

    // ê²€ìƒ‰ì–´ê°€ í¬í•¨ëœ í•€ë§Œ í•„í„°ë§í•˜ì—¬ í‘œì‹œ
    pins.forEach(pinObj => {
        const pinData = pinObj.pin.dataset;
        const matchesSearch = (
            pinData.name && pinData.name.toLowerCase().includes(searchTerm) ||
            pinData.building && pinData.building.toLowerCase().includes(searchTerm) ||
            pinData.category && pinData.category.toLowerCase().includes(searchTerm)
        );

        if (matchesSearch) {
            pinObj.pin.style.display = 'block'; // ì¼ì¹˜í•˜ë©´ í‘œì‹œ
        } else {
            pinObj.pin.style.display = 'none'; // ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ ìˆ¨ê¹€
        }
    });
    // ê²€ìƒ‰ì–´ê°€ ì—†ì„ ë•Œ
    if (searchTerm.length === 0) {
        searchResults.style.display = 'none';
        filterPins2(); // 1ìˆœìœ„ì™€ 3ìˆœìœ„ í•€ë§Œ í‘œì‹œ
        return;
    }
}

// ê²€ìƒ‰ì°½ì— ì…ë ¥ë  ë•Œë§ˆë‹¤ í•„í„°ë§ ì ìš©
searchInput.addEventListener('input', filterPinsBySearch);

// updateMapTransform í•¨ìˆ˜ ìˆ˜ì • 
function updateMapTransform() {
    const wrapperWidth = mapWrapper.offsetWidth;
    const wrapperHeight = mapWrapper.offsetHeight;
    const mapWidth = 1200 * currentScale;
    const mapHeight = 900 * currentScale;

    // ë§µì´ wrapperë³´ë‹¤ ì‘ì•„ì§€ì§€ ì•Šë„ë¡ ìµœì†Œ ìŠ¤ì¼€ì¼ ê³„ì‚°
    const minScaleX = wrapperWidth / 1200;
    const minScaleY = wrapperHeight / 900;
    const minScale = Math.max(minScaleX, minScaleY);

    // í˜„ì¬ ìŠ¤ì¼€ì¼ì´ ìµœì†Œ ìŠ¤ì¼€ì¼ë³´ë‹¤ ì‘ì•„ì§€ì§€ ì•Šë„ë¡ ì œí•œ
    if (currentScale < minScale) {
        currentScale = minScale;
    }

    // ê²½ê³„ ì œí•œ ê°•í™”
    const maxTranslateX = 0;
    const maxTranslateY = 0;
    const minTranslateX = wrapperWidth - mapWidth;
    const minTranslateY = wrapperHeight - mapHeight;

    // translate ê°’ ì œí•œ
    currentTranslateX = Math.min(maxTranslateX, Math.max(minTranslateX, currentTranslateX));
    currentTranslateY = Math.min(maxTranslateY, Math.max(minTranslateY, currentTranslateY));

    // transform ì ìš©
    mapContainer.style.transform = 
        `translate(${currentTranslateX}px, ${currentTranslateY}px) scale(${currentScale})`;

    // í•€ ì •ë³´ì°½ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    if (activeInfoBox && selectedPin) {
        const pinRect = selectedPin.getBoundingClientRect();
        activeInfoBox.style.left = `${pinRect.left}px`;
        activeInfoBox.style.top = `${pinRect.top - 100}px`;
    }
}

function animateScroll(targetX, targetY) {
    const duration = 800; // ì• ë‹ˆë©”ì´ì…˜ ì§€ì† ì‹œê°„ (ms)
    const startX = currentTranslateX;
    const startY = currentTranslateY;
    const deltaX = targetX - startX;
    const deltaY = targetY - startY;
    const startTime = performance.now();

    function scrollStep(currentTime) {
        const progress = Math.min((currentTime - startTime) / duration, 1);
        const easeProgress = 1 - Math.pow(1 - progress, 2); // easeOutQuad

        currentTranslateX = startX + deltaX * easeProgress;
        currentTranslateY = startY + deltaY * easeProgress;

        updateMapTransform();

        if (progress < 1) {
            requestAnimationFrame(scrollStep);
        }
    }

    requestAnimationFrame(scrollStep);
}

// í•€ ìƒì„± í•¨ìˆ˜ ìˆ˜ì •
function createPin(x, y, details = {}) {
    const pin = document.createElement('div');
    pin.className = 'pin'; // ê¸°ë³¸ í´ë˜ìŠ¤
    
    // ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ì¶”ê°€ í´ë˜ìŠ¤ ì ìš©
    if (details.priority === "1ìˆœìœ„") {
        pin.classList.add('pin-primary');
    } else if (details.priority === "2ìˆœìœ„") {
        pin.classList.add('pin-secondary');
    }

        // ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ì¶”ê°€ í´ë˜ìŠ¤ ì ìš©
        if (details.priority === "3ìˆœìœ„") {
        pin.classList.add('pin-secondary');
    }
    
    pin.style.left = `${x}px`;
    pin.style.top = `${y}px`;

    // í•€ì˜ ìš°ì„ ìˆœìœ„ ì„¤ì •
    pin.dataset.priority = details.priority || 'ë¯¸ì •';
    pin.dataset.building = details.building || 'ë¯¸ì •';

    
    const pinLabel = document.createElement('div');
    pinLabel.innerText = details.name || 'ì´ë¦„ ì—†ìŒ';
    pinLabel.style.display = 'none';

    if (details.priority === "1ìˆœìœ„") {
        pinLabel.className = 'pin-label';
    } else if (details.priority === "2ìˆœìœ„","3ìˆœìœ„") {
        pinLabel.className = 'pin-label2';
    }

    pin.appendChild(pinLabel);

    // ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ì´ë¦„ í‘œì‹œ
    pin.addEventListener('mouseenter', () => {
        pinLabel.style.display = 'block';
    });

    pin.addEventListener('mouseleave', () => {
        pinLabel.style.display = 'none';
    });

    // ëª¨ë°”ì¼ í„°ì¹˜ ì‹œ ì´ë¦„ í‘œì‹œ
    pin.addEventListener('touchstart', (e) => {
        e.stopPropagation();
        pinLabel.style.display = 'block';
        setTimeout(() => {
            pinLabel.style.display = 'none';
        }, 2000); // 2ì´ˆ í›„ ìë™ ìˆ¨ê¹€
    });

    let lastPrimaryPinPosition = null;

    const handlePinInteraction = function(e) {
    e.stopPropagation();

    if (details.priority === "1ìˆœìœ„") {
        lastPrimaryPinPosition = { x: pin.offsetLeft, y: pin.offsetTop }; // 1ìˆœìœ„ í•€ ìœ„ì¹˜ ì €ì¥
        moveToPin(pin); // í•´ë‹¹ ìœ„ì¹˜ë¡œ í™•ëŒ€ ì´ë™
        showPriorityPins(details.building);
        showExitButton();
        // ì›í•˜ëŠ” í™•ëŒ€ ë ˆë²¨ ì„¤ì •
        const targetScale = 6;
        // í™”ë©´(ë§µ wrapper)ì˜ í¬ê¸°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const wrapperWidth = mapWrapper.offsetWidth;
        const wrapperHeight = mapWrapper.offsetHeight;
        // ë¶€ë“œëŸ¬ìš´ í™•ëŒ€ ë° ì¤‘ì•™ ì´ë™: ì¤‘ì•™ ì¢Œí‘œë¥¼ ê¸°ì¤€ìœ¼ë¡œ smoothZoom í˜¸ì¶œ
        smoothZoom(targetScale, wrapperWidth / 2, wrapperHeight / 2);
        if (activeInfoBox) {
            activeInfoBox.style.display = 'none';
        }
    } else {
        showPinInfoBox(pin, details);
    }
};
    // ë°ìŠ¤í¬í†± í´ë¦­ ì´ë²¤íŠ¸
    pin.addEventListener('click', handlePinInteraction);
    
    // ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸
    pin.addEventListener('touchstart', function(e) {
        e.stopPropagation();  // ì§€ë„ì˜ í„°ì¹˜ ì´ë²¤íŠ¸ ì¤‘ì§€
        
        // í„°ì¹˜ ì‹œì‘ ì‹œê°„ ì €ì¥
        this.touchStartTime = new Date().getTime();
        this.touchStartX = e.touches[0].clientX;
        this.touchStartY = e.touches[0].clientY;
    });

    pin.addEventListener('touchend', function(e) {
        e.stopPropagation();  // ì§€ë„ì˜ í„°ì¹˜ ì´ë²¤íŠ¸ ì¤‘ì§€
        
        // í„°ì¹˜ ì¢…ë£Œ ì‹œê°„ê³¼ ì´ë™ ê±°ë¦¬ ê³„ì‚°
        const touchEndTime = new Date().getTime();
        const touchTime = touchEndTime - this.touchStartTime;
        const touchEndX = e.changedTouches[0].clientX;
        const touchEndY = e.changedTouches[0].clientY;
        const touchDistance = Math.hypot(
            touchEndX - this.touchStartX,
            touchEndY - this.touchStartY
        );

        // ì§§ì€ í„°ì¹˜(500ms ì´í•˜)ì™€ ì‘ì€ ì´ë™ ê±°ë¦¬(10px ì´í•˜)ì¼ ë•Œë§Œ í•€ ì •ë³´ í‘œì‹œ
        if (touchTime < 500 && touchDistance < 10) {
            handlePinInteraction(e);
        }
    });

    mapContainer.appendChild(pin);
    pins.push({
        pin,
        coordinates: { x, y },
        ...details
    });
}

// 1ìˆœìœ„ í•€ì„ í´ë¦­í–ˆì„ ë•Œ, í•´ë‹¹ ê±´ë¬¼ì— ì†í•˜ëŠ” 2ìˆœìœ„ í•€ ë³´ì´ê¸°
function showPriorityPins(buildingName) {
    // ëª¨ë“  1ìˆœìœ„ í•€ ìˆ¨ê¸°ê¸°
    pins.forEach(pinObj => {
        if (pinObj.pin.dataset.priority === "1ìˆœìœ„", "3ìˆœìœ„") {
            pinObj.pin.style.display = 'none'; // ëª¨ë“  1ìˆœìœ„ í•€ì„ ìˆ¨ê¹€
        }
    });

    // ëª¨ë“  í•€ ì¤‘ì—ì„œ "2ìˆœìœ„"ì´ê³ , ê±´ë¬¼ì´ í•´ë‹¹ ì´ë¦„ì¸ í•€ì„ ë³´ì´ê²Œ í•¨
    pins.forEach(pinObj => {
        if (pinObj.pin.dataset.priority === "2ìˆœìœ„" && pinObj.pin.dataset.building === buildingName) {
            pinObj.pin.style.display = 'block'; // í•´ë‹¹ 2ìˆœìœ„ í•€ì„ ë³´ì´ê²Œ í•¨
        } else if (pinObj.pin.dataset.priority === "2ìˆœìœ„") {
            pinObj.pin.style.display = 'none'; // 2ìˆœìœ„ í•€ ì¤‘ í•´ë‹¹ ê±´ë¬¼ì´ ì•„ë‹Œ ê²ƒì€ ìˆ¨ê¹€
        }
    });
}

// 2ìˆœìœ„ í•€ì´ ë³´ì¼ ë•Œ "ê±´ë¬¼ ë‚˜ê°€ê¸°" ë²„íŠ¼ê³¼ ì¸µ ë²„íŠ¼ë“¤ì„ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
function showExitButton() {
    if (exitButton === null) {
        exitButton = document.createElement('div');
        exitButton.className = 'exit-button-container';
        exitButton.style.position = 'absolute';
        exitButton.style.top = '200px';
        exitButton.style.left = '90%';
        exitButton.style.transform = 'translateX(-82%)';
        exitButton.style.display = 'flex';
        exitButton.style.flexDirection = 'column';
        exitButton.style.gap = '10px';
        
        const exitButtonElement = document.createElement('button');
        exitButtonElement.className = 'exit-button';
        exitButtonElement.innerText = 'ê±´ë¬¼ ë‚˜ê°€ê¸°';
        exitButtonElement.style.background = '#e155b5';
        exitButtonElement.style.color = 'white';
        exitButtonElement.style.padding = '8px 13px';
        exitButtonElement.style.borderRadius = '20px';
        exitButtonElement.style.whiteSpace = 'nowrap';
        exitButtonElement.style.fontSize = '14px';
        exitButtonElement.style.border = 'none';
        exitButtonElement.style.cursor = 'pointer';
        exitButtonElement.style.marginBottom = '10px';
        exitButtonElement.style.border = '2px solid rgb(213 213 213)';
        
        exitButtonElement.addEventListener('click', function() {
            hidePriorityPins();
            hideExitButton();
            filterPins2();
            if (activeInfoBox) {
                activeInfoBox.style.display = 'none';
            }
        });

        const floorButtonsContainer = document.createElement('div');
        floorButtonsContainer.style.display = 'flex';
        floorButtonsContainer.style.flexDirection = 'column';
        floorButtonsContainer.style.gap = '10px';
        floorButtonsContainer.className = 'floor-buttons-container';

        exitButton.appendChild(exitButtonElement);
        exitButton.appendChild(floorButtonsContainer);
        document.body.appendChild(exitButton);
    }

    const visibleSecondaryPin = document.querySelector('.pin[data-priority="2ìˆœìœ„"]:not([style*="display: none"])');
    if (visibleSecondaryPin) {
        const currentBuilding = visibleSecondaryPin.dataset.building;
        
        const buildingFloors = [...new Set(
            pinsData
                .filter(pin => pin.building === currentBuilding && pin.priority === "2ìˆœìœ„" && pin.floor)
                .map(pin => pin.floor)
        )];

        const floorButtonsContainer = exitButton.querySelector('.floor-buttons-container');
        floorButtonsContainer.innerHTML = '';

        // **ì¸µ ì •ë³´ê°€ ì—†ì„ ê²½ìš°, ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™” í›„ ì¢…ë£Œ**
        if (buildingFloors.length === 0) {
            return;
        }

        // Keep track of the currently selected floor button
        let selectedButton = null;

        buildingFloors.sort().reverse().forEach(floor => {
            const floorButton = document.createElement('button');
            floorButton.className = 'floor-button';
            floorButton.innerText = floor;
            floorButton.style.background = '#4a4a4a';
            floorButton.style.color = 'white';
            floorButton.style.padding = '8px 13px';
            floorButton.style.borderRadius = '20px';
            floorButton.style.whiteSpace = 'nowrap';
            floorButton.style.fontSize = '14px';
            floorButton.style.border = 'none';
            floorButton.style.cursor = 'pointer';
            floorButton.style.border = '2px solid #f79de0';
            floorButton.style.transition = 'background-color 0.3s ease'; // Add smooth transition

            floorButton.addEventListener('click', () => {
                // Reset previously selected button
                if (selectedButton) {
                    selectedButton.style.background = '#4a4a4a';
                }
                
                // Highlight current button
                floorButton.style.background = 'rgb(195, 73, 201)'; // Change to blue when selected
                selectedButton = floorButton;

                // Show pins for selected floor
                pins.forEach(pinObj => {
                    const isTargetPin = 
                        pinObj.pin.dataset.priority === "2ìˆœìœ„" && 
                        pinObj.building === currentBuilding && 
                        pinObj.floor === floor;
                    
                    pinObj.pin.style.display = isTargetPin ? 'block' : 'none';
                });
            });
            
            floorButtonsContainer.appendChild(floorButton);
        });

        // ì¶”ê°€: "1ì¸µ" ë²„íŠ¼ ìë™ ì„ íƒ (ì¡´ì¬í•  ê²½ìš°)
        const oneFloorButton = Array.from(floorButtonsContainer.children)
            .find(btn => btn.innerText.trim() === '1ì¸µ');
        if(oneFloorButton){
            oneFloorButton.click();
        }
    }

    exitButton.style.display = 'block';
}

// ì„ íƒëœ ì¸µì˜ í•€ë§Œ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
function highlightSelectedFloor(selectedFloor) {
    pins.forEach(pinObj => {
        if (pinObj.pin.dataset.priority === "2ìˆœìœ„") {
            // í•€ì˜ ì¸µ ì •ë³´ì™€ ì„ íƒëœ ì¸µì´ ì¼ì¹˜í•˜ëŠ” ê²½ìš°ì—ë§Œ í‘œì‹œ
            const pinFloor = pinObj.floor ? pinObj.floor.toUpperCase() : null;
            if (pinFloor === selectedFloor) {
                pinObj.pin.style.display = 'block';
            } else {
                pinObj.pin.style.display = 'none';
            }
        }
    });
}

// "ê±´ë¬¼ ë‚˜ê°€ê¸°" ë²„íŠ¼ì„ ìˆ¨ê¸°ëŠ” í•¨ìˆ˜
function hideExitButton() {
    if (exitButton) { // ë²„íŠ¼ì´ ì¡´ì¬í•  ë•Œë§Œ ì‹¤í–‰
        exitButton.style.display = 'none';
    }
}

// "1ìˆœìœ„"ë§Œ ë³´ì´ë„ë¡ 2ìˆœìœ„ í•€ì„ ìˆ¨ê¸°ëŠ” í•¨ìˆ˜
function hidePriorityPins() {
    pins.forEach(pinObj => {
        if (pinObj.pin.dataset.priority === "2ìˆœìœ„") {
            pinObj.pin.style.display = 'none'; // ëª¨ë“  2ìˆœìœ„ í•€ì„ ìˆ¨ê¹€
        }
    });
    showOnlyFirstPriorityPins(); // 1ìˆœìœ„ í•€ë§Œ ë³´ì´ê²Œ
}

// 1ìˆœìœ„ í•€ë§Œ ë³´ì´ë„ë¡ í•˜ëŠ” í•¨ìˆ˜
function showOnlyFirstPriorityPins() {
    pins.forEach(pinObj => {
        if (pinObj.pin.dataset.priority === "1ìˆœìœ„") {
            pinObj.pin.style.display = 'block'; // 1ìˆœìœ„ í•€ë§Œ ë³´ì´ê²Œ í•¨
        }
    });
}

// í•€ ì •ë³´ì°½ í‘œì‹œ í•¨ìˆ˜
function showPinInfoBox(pin, pinData) {
    if (activeInfoBox) {
        activeInfoBox.remove();
    }

    const pinRect = pin.getBoundingClientRect();
    const infoBox = document.createElement('div');
    infoBox.className = 'pin-info-box';
    
    // ëª¨ë°”ì¼ ì—¬ë¶€ í™•ì¸
    const isMobile = window.innerWidth <= 768;
    
    if (isMobile) {
        // ëª¨ë°”ì¼ì—ì„œëŠ” í™”ë©´ ì¤‘ì•™ì— í‘œì‹œ
        infoBox.style.left = '50%';
        infoBox.style.top = '50%';
        infoBox.style.transform = 'translate(-50%, -50%)';
    } else {
        // ë°ìŠ¤í¬í†±ì—ì„œëŠ” ê¸°ì¡´ ìœ„ì¹˜ ìœ ì§€
        infoBox.style.left = `${pinRect.left + 100}px`;
        infoBox.style.top = `${pinRect.top - 100}px`;
    }
    
    infoBox.style.left = `${pinRect.left + 100}px`;
    infoBox.style.top = `${pinRect.top - 100}px`;

    const closeBtn = document.createElement('span');
    closeBtn.className = 'close-btn';
    closeBtn.innerHTML = 'Ã—';
    closeBtn.onclick = function(e) {
        e.stopPropagation();
        infoBox.style.display = 'none';
        activeInfoBox = null;
    };
    infoBox.appendChild(closeBtn);

    // ê°’ì´ ìˆëŠ” í•­ëª©ë§Œ í‘œì‹œí•˜ë„ë¡ ìˆ˜ì •
    const info = [];
    if (pinData.name) info.push(`<strong>ì´ë¦„:</strong> ${pinData.name}`);
    if (pinData.address) info.push(`<strong>ê±´ë¬¼ë²ˆí˜¸:</strong> ${pinData.address}`);
    if (pinData.number) info.push(`<strong>ì—°ë½ì²˜:</strong> ${pinData.number}`);
    if (pinData.building) info.push(`<strong>ê±´ë¬¼:</strong> ${pinData.building}`);
    if (pinData.floor) info.push(`<strong>ì¸µ:</strong> ${pinData.floor}`);
    if (pinData.category) info.push(`<strong>ì¹´í…Œê³ ë¦¬:</strong> ${pinData.category}`);
    if (pinData.description) info.push(`<strong>ì„¤ëª…:</strong> ${pinData.description}`);
    if (pinData.link) info.push(`<strong>ì£¼ì†Œ:</strong> <a href="${pinData.link}" target="_blank">${pinData.link}</a>`);

    infoBox.innerHTML += info.join('<br>');
    
    document.body.appendChild(infoBox);
    infoBox.style.display = 'block';
    activeInfoBox = infoBox;
    selectedPin = pin;

    // ì •ë³´ì°½ì´ í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šë„ë¡ ì¡°ì •
    const infoBoxRect = infoBox.getBoundingClientRect();
    if (infoBoxRect.top < 0) {
        infoBox.style.top = '10px';
    }
    if (infoBoxRect.left < 0) {
        infoBox.style.left = '10px';
    }
    if (infoBoxRect.right > window.innerWidth) {
        infoBox.style.left = `${window.innerWidth - infoBoxRect.width - 10}px`;
    }

        // í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        closeBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        infoBox.remove();
        activeInfoBox = null;
        selectedPin = null;
    });

    infoBox.appendChild(closeBtn);
}

// í•„í„°ë§ í•¨ìˆ˜
function filterPins() {
    const buildingFilter = document.getElementById('building-filter').value;
    const floorFilter = document.getElementById('floor-filter').value;
    
    // ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ì²´í¬ë°•ìŠ¤ ê°’ ê°€ì ¸ì˜¤ê¸°
    const selectedCategories = [...document.querySelectorAll('input[name="category"]:checked')]
        .map(checkbox => checkbox.value);
    
    // ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°
    const searchTerm = searchInput.value.trim().toLowerCase();
    
    // í•„í„° ë° ê²€ìƒ‰ì´ ëª¨ë‘ ë¹„ì–´ìˆìœ¼ë©´ filterPins2 ì‹¤í–‰
    if (!buildingFilter && !floorFilter && selectedCategories.length === 0 && searchTerm === "") {
        filterPins2(); // 1ìˆœìœ„ì™€ 3ìˆœìœ„ í•€ë§Œ í‘œì‹œ
        return;
    }

    // í•„í„°ë§ ì ìš©
    pins.forEach(pinObj => {
        const matchesBuilding = !buildingFilter || pinObj.building === buildingFilter;
        const matchesFloor = !floorFilter || pinObj.floor === floorFilter;
        const matchesCategory = selectedCategories.length === 0 || selectedCategories.includes(pinObj.category);
        const matchesSearch = (
            pinObj.name && pinObj.name.toLowerCase().includes(searchTerm) ||
            pinObj.building && pinObj.building.toLowerCase().includes(searchTerm) ||
            pinObj.category && pinObj.category.toLowerCase().includes(searchTerm)
        );

        if (matchesBuilding && matchesFloor && matchesCategory && matchesSearch) {
            pinObj.pin.style.display = 'block';
        } else {
            pinObj.pin.style.display = 'none';
        }
    });
}

// í•„í„°ë§ í•¨ìˆ˜ ìˆ˜ì • - ìµœì´ˆ ì‹¤í–‰ì‹œ 1ìˆœìœ„ í•€ë§Œ ë³´ì´ë„ë¡
function filterPins2() {
    const priorityFilter = "1ìˆœìœ„";
    
    pins.forEach(pinObj => {
        // 1ìˆœìœ„ì´ê±°ë‚˜ 3ìˆœìœ„ì¸ í•€ë§Œ í‘œì‹œ
        const matchesPriority = pinObj.priority === priorityFilter || pinObj.priority === "3ìˆœìœ„";
        
        if (matchesPriority) {
            pinObj.pin.style.display = 'block';
        } else {
            pinObj.pin.style.display = 'none';
        }
    });
}

// íŠ¹ì • í•€ìœ¼ë¡œ ì´ë™í•˜ëŠ” í•¨ìˆ˜
function moveToPin(pin) {
    const pinRect = pin.getBoundingClientRect();
    const wrapperRect = mapWrapper.getBoundingClientRect();
    
    const targetX = -(pin.offsetLeft * currentScale - (wrapperRect.width / 2));
    const targetY = -(pin.offsetTop * currentScale - (wrapperRect.height / 2));
    
    mapContainer.style.transition = 'transform 0.5s ease-out';
    currentTranslateX = targetX;
    currentTranslateY = targetY;
    updateMapTransform();
    
    setTimeout(() => {
        mapContainer.style.transition = '';
    }, 500);
}

// í„°ì¹˜ ì´ë²¤íŠ¸ ê´€ë ¨ ë³€ìˆ˜
let initialTouchDistance = 0;
let lastTouchX = 0;
let lastTouchY = 0;
let isTouching = false;
let lastTapTime = 0;
let initialPinchScale = 1;
let pinchStartX = 0;  // í•€ì¹˜ ì‹œì‘ X ì¢Œí‘œ
let pinchStartY = 0;  // í•€ì¹˜ ì‹œì‘ Y ì¢Œí‘œ
let exitButton = null;

// í„°ì¹˜ ì‹œì‘ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
mapContainer.addEventListener('touchstart', function(e) {
    e.preventDefault();
    isTouching = true;
    
    if (e.touches.length === 1) {
        e.preventDefault();  // ê¸°ë³¸ iOS í™•ëŒ€ ë°©ì§€
        // ì‹±ê¸€ í„°ì¹˜ (ì´ë™)
        const touch = e.touches[0];
        lastTouchX = touch.clientX;
        lastTouchY = touch.clientY;
        
        // ë”ë¸” íƒ­ í™•ì¸
        const currentTime = new Date().getTime();
        const tapLength = currentTime - lastTapTime;
        
        if (tapLength < 300 && tapLength > 0) {
            // ë”ë¸” íƒ­ í™•ëŒ€
            const touch = e.touches[0];
            const targetScale = currentScale === mapConfig.maxScale ? 
                mapConfig.minScale : Math.min(currentScale * 2, mapConfig.maxScale);
            
            smoothZoom(targetScale, touch.clientX, touch.clientY);
        }
        
        lastTapTime = currentTime;
        
    } else if (e.touches.length === 2) {
        // ë©€í‹° í„°ì¹˜ (í•€ì¹˜ ì¤Œ)
        const touch1 = e.touches[0];
        const touch2 = e.touches[1];
        
        // í•€ì¹˜ ì‹œì‘ ì§€ì  ì €ì¥ (ë‘ ì†ê°€ë½ì˜ ì¤‘ì‹¬ì )
        pinchStartX = (touch1.clientX + touch2.clientX) / 2;
        pinchStartY = (touch1.clientY + touch2.clientY) / 2;
        
        initialTouchDistance = Math.hypot(
            touch2.clientX - touch1.clientX,
            touch2.clientY - touch1.clientY
        );
        initialPinchScale = currentScale;
    }
});

// IOS í„°ì¹˜ë°©ì§€
document.addEventListener('gesturestart', function (e) {
    e.preventDefault(); // iOS Safari ê¸°ë³¸ í™•ëŒ€ ë°©ì§€
});

// í„°ì¹˜ ì´ë™ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
mapContainer.addEventListener('touchmove', function(e) {
    e.preventDefault();
    
    if (!isTouching) return;
    
    if (e.touches.length === 1) {
        // ì‹±ê¸€ í„°ì¹˜ (ì´ë™)
        const touch = e.touches[0];
        const deltaX = touch.clientX - lastTouchX;
        const deltaY = touch.clientY - lastTouchY;
        
        currentTranslateX += deltaX;
        currentTranslateY += deltaY;
        
        lastTouchX = touch.clientX;
        lastTouchY = touch.clientY;
        
        updateMapTransform();
        
    } else if (e.touches.length === 2) {
        // ë©€í‹° í„°ì¹˜ (í•€ì¹˜ ì¤Œ)
        const touch1 = e.touches[0];
        const touch2 = e.touches[1];
        
        // í˜„ì¬ í„°ì¹˜ í¬ì¸íŠ¸ ê°„ì˜ ê±°ë¦¬ ê³„ì‚°
        const currentTouchDistance = Math.hypot(
            touch2.clientX - touch1.clientX,
            touch2.clientY - touch1.clientY
        );
        
        // ìŠ¤ì¼€ì¼ ê³„ì‚°
        const scaleFactor = currentTouchDistance / initialTouchDistance;
        const targetScale = Math.min(
            Math.max(
                mapConfig.minScale,
                initialPinchScale * scaleFactor
            ),
            mapConfig.maxScale
        );
        
        // í•€ì¹˜ ì‹œì‘ ì§€ì ì„ ê¸°ì¤€ìœ¼ë¡œ í™•ëŒ€/ì¶•ì†Œ
        const rect = mapWrapper.getBoundingClientRect();
        const mouseX = pinchStartX - rect.left;
        const mouseY = pinchStartY - rect.top;
        
        // ë§µ ìƒì˜ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ ê³„ì‚°
        const mapX = (mouseX - currentTranslateX) / currentScale;
        const mapY = (mouseY - currentTranslateY) / currentScale;
        
        // ì¦‰ì‹œ í™•ëŒ€/ì¶•ì†Œ ì ìš©
        currentScale = targetScale;
        
        // í•€ì¹˜ ì‹œì‘ ì§€ì ì„ ê¸°ì¤€ìœ¼ë¡œ ìƒˆë¡œìš´ translate ê°’ ê³„ì‚°
        currentTranslateX = mouseX - (mapX * currentScale);
        currentTranslateY = mouseY - (mapY * currentScale);
        
        updateMapTransform();
    }
});

// í„°ì¹˜ ì¢…ë£Œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
mapContainer.addEventListener('touchend', function(e) {
    isTouching = false;
    initialTouchDistance = 0;
    initialPinchScale = currentScale;
    pinchStartX = 0;
    pinchStartY = 0;
    
    // ë°”ìš´ìŠ¤ íš¨ê³¼ ì ìš©
    const wrapperWidth = mapWrapper.offsetWidth;
    const wrapperHeight = mapWrapper.offsetHeight;
    const mapWidth = 1200 * currentScale;
    const mapHeight = 900 * currentScale;
    
    const minX = Math.min(0, wrapperWidth - mapWidth);
    const minY = Math.min(0, wrapperHeight - mapHeight);
    
    if (currentTranslateX < minX || currentTranslateX > 0 ||
        currentTranslateY < minY || currentTranslateY > 0) {
        
        mapContainer.style.transition = 'transform 0.3s ease-out';
        currentTranslateX = Math.max(minX, Math.min(0, currentTranslateX));
        currentTranslateY = Math.max(minY, Math.min(0, currentTranslateY));
        updateMapTransform();
        
        setTimeout(() => {
            mapContainer.style.transition = '';
        }, 300);
    }
});

// í„°ì¹˜ ì·¨ì†Œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
mapContainer.addEventListener('touchcancel', function() {
    isTouching = false;
    initialTouchDistance = 0;
    initialPinchScale = currentScale;
    pinchStartX = 0;
    pinchStartY = 0;
});

// ë¶€ë“œëŸ¬ìš´ ì¤Œ í•¨ìˆ˜
function smoothZoom(targetScale, mouseX, mouseY) {
    const startScale = currentScale;
    const scaleDiff = targetScale - startScale;
    const duration = 300;
    
    if (zoomAnimation) {
        cancelAnimationFrame(zoomAnimation);
    }

    // í˜„ì¬ ë·°í¬íŠ¸ ìƒì˜ ë§ˆìš°ìŠ¤ ìœ„ì¹˜
    const viewportX = mouseX;
    const viewportY = mouseY;

    // í˜„ì¬ ë§µ ìƒì˜ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ ê³„ì‚°
    const mapX = (viewportX - currentTranslateX) / currentScale;
    const mapY = (viewportY - currentTranslateY) / currentScale;

    const startTime = performance.now();
    
    function animate(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        // easeOutQuad ì´ì§• í•¨ìˆ˜ ì‚¬ìš©
        const easeProgress = 1 - (1 - progress) * (1 - progress);
        const newScale = startScale + (scaleDiff * easeProgress);
        
        // ìƒˆë¡œìš´ translate ê°’ ê³„ì‚°
        // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ëŠ” ê³ ì •ëœ ì±„ë¡œ í™•ëŒ€/ì¶•ì†Œë˜ì–´ì•¼ í•¨
        const newTranslateX = viewportX - (mapX * newScale);
        const newTranslateY = viewportY - (mapY * newScale);

        // ê²½ê³„ í™•ì¸
        const mapWidth = 1200 * newScale;
        const mapHeight = 900 * newScale;
        const wrapperWidth = mapWrapper.offsetWidth;
        const wrapperHeight = mapWrapper.offsetHeight;

        // ë§µì´ í™”ë©´ ë°–ìœ¼ë¡œ ë„ˆë¬´ ë§ì´ ë‚˜ê°€ì§€ ì•Šë„ë¡ ì œí•œ
        const minX = Math.min(0, wrapperWidth - mapWidth);
        const minY = Math.min(0, wrapperHeight - mapHeight);

        currentScale = newScale;
        currentTranslateX = Math.max(minX, Math.min(0, newTranslateX));
        currentTranslateY = Math.max(minY, Math.min(0, newTranslateY));
        
        updateMapTransform();
        
        if (progress < 1) {
            zoomAnimation = requestAnimationFrame(animate);
        }
    }
    
    zoomAnimation = requestAnimationFrame(animate);
}

// ë§ˆìš°ìŠ¤ ë‹¤ìš´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
mapContainer.addEventListener('mousedown', (e) => {
    isDragging = true;
    startX = e.clientX;
    startY = e.clientY;
    mapContainer.style.cursor = 'grabbing';
});

// ë§ˆìš°ìŠ¤ ì´ë™ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—…ë°ì´íŠ¸
document.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    e.preventDefault();
    const deltaX = e.clientX - startX;
    const deltaY = e.clientY - startY;
    
    currentTranslateX += deltaX;
    currentTranslateY += deltaY;
    
    startX = e.clientX;
    startY = e.clientY;
    
    updateMapTransform();
});

document.addEventListener('mouseup', () => {
    isDragging = false;
    mapContainer.style.cursor = 'grab';
});

// Xí‚¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
document.addEventListener('keydown', function(e) {
    if (e.key === 'x' || e.key === 'X') {
        if (activeInfoBox) {
            activeInfoBox.style.display = 'none';
            activeInfoBox = null;
        }
        if (searchResults.style.display === 'block') {
            searchResults.style.display = 'none';
            searchInput.value = '';
        }
    }
});

function generateBuildingList() {
    // 2ìˆœìœ„ í•€ë“¤ë§Œ í•„í„°ë§
    const secondaryPins = pinsData.filter(pin => pin.priority === "2ìˆœìœ„");
    
    // ê±´ë¬¼ë³„ë¡œ ê·¸ë£¹í™”
    const buildingGroups = {};
    secondaryPins.forEach(pin => {
        if (!buildingGroups[pin.building]) {
            buildingGroups[pin.building] = new Set();
        }
        if (pin.floor) {
            buildingGroups[pin.building].add(pin.floor);
        }
    });

    // ê±´ë¬¼ ë¦¬ìŠ¤íŠ¸ HTML ìƒì„±
    const buildingContainer = document.querySelector('.building-container');
    buildingContainer.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

    // X ë²„íŠ¼ ì¶”ê°€
    const closeButton = document.createElement('div');
    closeButton.innerHTML = '&times;';
    closeButton.style.cssText = `
        position: sticky;
        top: 10px;
        right: 10px;
        font-size: 24px;
        cursor: pointer;
        float: right;
        padding: 5px 10px;
        z-index: 1000;
    `;
    closeButton.addEventListener('click', () => {
        document.querySelector('.building-list').style.display = 'none';
        filterPins2()
        if (activeInfoBox) {
                activeInfoBox.style.display = 'none';
            }
    });
    buildingContainer.appendChild(closeButton);
    
    Object.entries(buildingGroups).forEach(([building, floors]) => {
        const buildingSection = document.createElement('div');
        buildingSection.className = 'building-section';
        
        // ê±´ë¬¼ëª… í—¤ë”
        const header = document.createElement('h3');
        header.textContent = building;
        buildingSection.appendChild(header);

        // ì¸µ ë²„íŠ¼ë“¤ì„ ë‹´ì„ ì»¨í…Œì´ë„ˆ
        const floorList = document.createElement('div');
        floorList.className = 'floor-list';

        // ì¸µ ì •ë³´ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¸µ ë²„íŠ¼ ìƒì„±
        if (floors.size > 0) {
            // ì¸µ ì •ë³´ë¥¼ ì •ë ¬ (ìˆ«ì ìˆœ)
            const sortedFloors = Array.from(floors).sort((a, b) => {
                const numA = parseInt(a);
                const numB = parseInt(b);
                return numB - numA;  // ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
            });

            sortedFloors.forEach(floor => {
                const floorButton = document.createElement('button');
                floorButton.className = 'floor-item';
                floorButton.textContent = floor;
                
                // ì¸µ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
                floorButton.addEventListener('click', () => {
                    // í•´ë‹¹ ê±´ë¬¼ì˜ í•´ë‹¹ ì¸µì— ìˆëŠ” 2ìˆœìœ„ í•€ë§Œ í‘œì‹œ
                    pins.forEach(pinObj => {
                        if (pinObj.pin.dataset.priority === "2ìˆœìœ„" && 
                            pinObj.building === building && 
                            pinObj.floor === floor) {
                            pinObj.pin.style.display = 'block';
                            if (activeInfoBox) {
                                activeInfoBox.style.display = 'none';
                            }
                        } else {
                            pinObj.pin.style.display = 'none';
                        }
                    });
                });
                
                floorList.appendChild(floorButton);
            });
        }

        buildingSection.appendChild(floorList);

        // ê±´ë¬¼ë³„ ìœ„ì¹˜ ë¦¬ìŠ¤íŠ¸ ìƒì„±
        const locationsList = document.createElement('div');
        locationsList.className = 'locations-list';
        
        // í•´ë‹¹ ê±´ë¬¼ì˜ 2ìˆœìœ„ í•€ë“¤ í‘œì‹œ
        secondaryPins.filter(pin => pin.building === building).forEach(pin => {
            const locationItem = document.createElement('div');
            locationItem.className = 'location-item';
            locationItem.textContent = `${pin.floor ? pin.floor + ' - ' : ''}${pin.name || 'ì´ë¦„ ì—†ìŒ'}`;
            
            // ìœ„ì¹˜ í•­ëª© í´ë¦­ ì´ë²¤íŠ¸
            locationItem.addEventListener('click', () => {
                const pinObj = pins.find(p => 
                    p.coordinates.x == pin.x && 
                    p.coordinates.y == pin.y
                );
                if (pinObj) {
                    // í•´ë‹¹ í•€ë§Œ í‘œì‹œí•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ìˆ¨ê¹€
                    pins.forEach(p => {
                        p.pin.style.display = 'none';
                    });
                    pinObj.pin.style.display = 'block';
                    moveToPin(pinObj.pin);
                    showPinInfoBox(pinObj.pin, pin);
                }
            });
            
            locationsList.appendChild(locationItem);
        });

        buildingSection.appendChild(locationsList);
        buildingContainer.appendChild(buildingSection);
    });
}

// ê±´ë¬¼ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ìˆ˜ì •
document.querySelector('.nav-item:nth-child(2)').addEventListener('click', function(e) {
    e.preventDefault();
    const buildingList = document.querySelector('.building-list');
    if (buildingList.style.display === 'none') {
        generateBuildingList(); // ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ì „ì— ë™ì ìœ¼ë¡œ ìƒì„±
        buildingList.style.display = 'block';
    } else {
        buildingList.style.display = 'none';
    }
    
});

// ì™¸ë¶€ í´ë¦­ ì‹œ ë¦¬ìŠ¤íŠ¸ ë‹«ê¸° ì´ë²¤íŠ¸
document.addEventListener('click', function(e) {
    const buildingList = document.querySelector('.building-list');
    const navItem = document.querySelector('.nav-item:nth-child(2)');
    
    if (buildingList && buildingList.style.display !== 'none' &&
        !buildingList.contains(e.target) && !navItem.contains(e.target)) {
        buildingList.style.display = 'none';
        filterPins2()
        if (activeInfoBox) {
                activeInfoBox.style.display = 'none';
            }
    }
});

document.addEventListener("DOMContentLoaded", function () {
    const popup = document.getElementById("popup");
    const openPopup = document.getElementById("openPopup");
    const closePopup = document.querySelector(".close");

    // íŒì—… ì—´ê¸°
    openPopup.addEventListener("click", function (event) {
        event.preventDefault(); // ê¸°ë³¸ ë§í¬ ë™ì‘ ë°©ì§€
        popup.style.display = "flex";
    });

    // íŒì—… ë‹«ê¸° (X ë²„íŠ¼)
    closePopup.addEventListener("click", function () {
        popup.style.display = "none";
    });

    // íŒì—… ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    window.addEventListener("click", function (event) {
        if (event.target === popup) {
            popup.style.display = "none";
        }
    });
});

// wheel ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ìˆ˜ì •
mapWrapper.addEventListener('wheel', function(e) {
    e.preventDefault();
    
    const rect = mapWrapper.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    // í˜„ì¬ ë§µì˜ í¬ê¸° ê³„ì‚°
    const wrapperWidth = mapWrapper.offsetWidth;
    const wrapperHeight = mapWrapper.offsetHeight;
    const minScaleX = wrapperWidth / 1200;
    const minScaleY = wrapperHeight / 900;
    const minScale = Math.max(minScaleX, minScaleY);

    const delta = -e.deltaY / Math.abs(e.deltaY); // ë°©í–¥ë§Œ ì¶”ì¶œ (+1 ë˜ëŠ” -1)
    
    // ì¶•ì†Œí•˜ë ¤ê³  í•  ë•Œ (delta < 0) ìµœì†Œ ìŠ¤ì¼€ì¼ì— ë„ë‹¬í–ˆë‹¤ë©´ ë” ì´ìƒ ì¶•ì†Œí•˜ì§€ ì•ŠìŒ
    if (delta < 0 && currentScale <= minScale) {
        return;
    }
    
    const zoomFactor = 0.6; // ì¤Œ ì†ë„ ì¡°ì ˆ (ê°’ì´ ì‘ì„ìˆ˜ë¡ ë¶€ë“œëŸ¬ì›€)
    const targetScale = Math.min(
        Math.max(
            minScale,
            currentScale * (1 + delta * zoomFactor)
        ),
        mapConfig.maxScale
    );
    
    // í˜„ì¬ ìŠ¤ì¼€ì¼ê³¼ ëª©í‘œ ìŠ¤ì¼€ì¼ì´ ì¶©ë¶„íˆ ë‹¤ë¥¸ ê²½ìš°ì—ë§Œ ì¤Œ ì‹¤í–‰
    if (Math.abs(targetScale - currentScale) > 0.01) {
        smoothZoom(targetScale, mouseX, mouseY);
    }
});

// í´ë¦­ ì´ë²¤íŠ¸ë¡œ ì •ë³´ì°½ê³¼ ê²€ìƒ‰ê²°ê³¼ ë‹«ê¸°
// mapWrapper.addEventListener('click', function() {
//     if (activeInfoBox) {
//         activeInfoBox.style.display = 'none';
//         activeInfoBox = null;
//     }
//     searchResults.style.display = 'none';
//     searchInput.value = '';
// });

// ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸
window.addEventListener('resize', function() {
    updateMapTransform();
    if (activeInfoBox && selectedPin) {
        const pinRect = selectedPin.getBoundingClientRect();
        activeInfoBox.style.left = `${pinRect.left}px`;
        activeInfoBox.style.top = `${pinRect.top - 100}px`;
    }
});

// ì•± ì´ˆê¸°í™”
function initializeMap() {
    // ëª¨ë°”ì¼ ì—¬ë¶€ í™•ì¸
    const isMobile = window.innerWidth <= 768;
    
    // ëª¨ë°”ì¼/ë°ìŠ¤í¬í†±ì— ë”°ë¥¸ ì´ˆê¸° ì„¤ì • ì ìš©
    currentScale = isMobile ? mapConfig.mobile.initialScale : mapConfig.initialScale;
    
    const wrapperWidth = mapWrapper.offsetWidth;
    const wrapperHeight = mapWrapper.offsetHeight;
    const mapWidth = 1200 * currentScale;
    const mapHeight = 900 * currentScale;
    
    if (isMobile) {
        currentTranslateX = mapConfig.mobile.initialX;
        currentTranslateY = mapConfig.mobile.initialY;
    } else {
        if (mapConfig.initialX === 0 && mapConfig.initialY === 0) {
            currentTranslateX = (wrapperWidth - mapWidth) / 2;
            currentTranslateY = (wrapperHeight - mapHeight) / 2;
        } else {
            currentTranslateX = mapConfig.initialX;
            currentTranslateY = mapConfig.initialY;
        }
    }
    
    updateMapTransform();
}

// í•„í„° ì„¤ì •
function setupFilters() {
    const filters = ['building-filter', 'floor-filter', 'category-filter'];
    filters.forEach(filterId => {
        document.getElementById(filterId).addEventListener('change', filterPins);
    });
}

function handleUrlPinLocation() {
    const path = window.location.pathname;
    const locationName = decodeURIComponent(path.split('/').pop());
    const searchTerm = locationName.toLowerCase();

    // 1ë‹¨ê³„: ì „ì²´ ê²€ìƒ‰ì–´ë¡œ í•€ ê²€ìƒ‰
    let matchedPin = pinsData.find(pin => 
        (pin.name && pin.name.toLowerCase().includes(searchTerm)) || 
        (pin.building && pin.building.toLowerCase().includes(searchTerm))
    );

    // 2ë‹¨ê³„: ì „ì²´ ê²€ìƒ‰ì–´ë¡œ ì°¾ì§€ ëª»í–ˆì„ ê²½ìš°, ë§ˆì§€ë§‰ ë‹¨ì–´ë¡œ ì¬ê²€ìƒ‰
    if (!matchedPin) {
        const tokens = searchTerm.split(' ');
        if (tokens.length > 1) {
            const lastToken = tokens[tokens.length - 1];
            matchedPin = pinsData.find(pin =>
                (pin.name && pin.name.toLowerCase().includes(lastToken)) ||
                (pin.building && pin.building.toLowerCase().includes(lastToken))
            );
        }
    }

    if (matchedPin) {
        // ëª¨ë“  í•€ì„ ìˆ¨ê¹€
        pins.forEach(p => {
            p.pin.style.display = 'none';
        });
        
        const pinObj = pins.find(p => 
            p.coordinates.x == matchedPin.x && 
            p.coordinates.y == matchedPin.y
        );

        if (pinObj) {
            // í•´ë‹¹ í•€ë§Œ í‘œì‹œí•˜ê³  ê°•ì¡°
            pinObj.pin.style.display = 'block';
            pinObj.pin.style.transform = 'translate(-50%, -95%) scale(1.5)';
            pinObj.pin.style.zIndex = '1001';
            
            moveToPin(pinObj.pin);
            showPinInfoBox(pinObj.pin, matchedPin);

            // ì „ì²´ ì§€ë„ë³´ê¸° ë²„íŠ¼ ìƒì„± (ì„ íƒ ì‚¬í•­)
            const viewAllButton = document.createElement('button');
            viewAllButton.innerText = 'ì „ì²´ ì§€ë„ ë³´ê¸°';
            viewAllButton.style.cssText = `
                position: fixed;
                bottom: 100px;
                left: 50%;
                transform: translateX(-50%);
                padding: 12px 24px;
                background: #e155b5;
                color: white;
                border: none;
                border-radius: 20px;
                font-size: 16px;
                cursor: pointer;
                box-shadow: 0 2px 6px rgba(0,0,0,0.2);
                z-index: 1002;
            `;
            
            viewAllButton.addEventListener('click', () => {
                // ì „ì²´ í•€ í‘œì‹œ ë° ê°•ì¡° íš¨ê³¼ ì œê±°
                pinObj.pin.style.transform = 'translate(-50%, -95%)';
                pinObj.pin.style.filter = 'none';
                filterPins2();
                if (activeInfoBox) {
                    activeInfoBox.style.display = 'none';
                }
                viewAllButton.remove();
            });
            
            document.body.appendChild(viewAllButton);
        }
    } else {
        alert(`"${locationName}"ì— í•´ë‹¹í•˜ëŠ” ìœ„ì¹˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
    }
}


document.addEventListener('DOMContentLoaded', function() {
    const pathParts = window.location.pathname.split('/');
    const locationName = pathParts[pathParts.length - 1];
    
    if (locationName && locationName !== 'DIMAMAP') {
        setTimeout(handleUrlPinLocation, 500);
    }
});

// DOMì´ ë¡œë“œë˜ë©´ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', function() {
    initializeMap();
    initializeFilterOptions();
    setupFilters();
    
    // ëª¨ë“  í•€ ìƒì„±
    pinsData.forEach(pinData => createPin(pinData.x, pinData.y, pinData));
    
    // ìµœì´ˆ ì‹¤í–‰ ì‹œ 1ìˆœìœ„ í•€ë§Œ í‘œì‹œ
    filterPins2();
    
    // ë¶ˆí•„ìš”í•œ í•„í„° ì ìš© ë²„íŠ¼ ì œê±°
    const applyButton = document.getElementById('apply-filters');
    if (applyButton) {
        applyButton.remove();
    }
});

document.addEventListener('contextmenu', function(event) {
    event.preventDefault();  // ìš°í´ë¦­ ë°©ì§€
});
    </script>
</body>
</html>
